/**
 * @name email-comb
 * @fileoverview Remove unused CSS from email templates
 * @version 6.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/email-comb/}
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).emailComb={})}(this,(function(e){"use strict";
/**
 * @name arrayiffy-if-string
 * @fileoverview Put non-empty strings into arrays, turn empty-ones into empty arrays. Bypass everything else.
 * @version 4.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/arrayiffy-if-string/}
 */
/**
 * @name string-match-left-right
 * @fileoverview Match substrings on the left or right of a given index, ignoring whitespace
 * @version 8.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-match-left-right/}
 */
function t(e){return e&&"object"==typeof e&&!Array.isArray(e)}function r(e){return"string"==typeof e}const n={cb:void 0,i:!1,trimBeforeMatching:!1,trimCharsBeforeMatching:[],maxMismatches:0,firstMustMatch:!1,lastMustMatch:!1,hungry:!1},i=e=>e+1;function s(e,t,r,s,o=!1,l=i){const a="function"==typeof r?r():r;if(+t<0&&o&&"EOL"===a)return a;const u={...n,...s};if(t>=e.length&&!o)return!1;let c=o?1:r.length,f=0,h=!1,g=!1,p=!1,d=u.maxMismatches,m=t,y=!1,T=!1,v=!1;function b(){return 1===f&&d<u.maxMismatches-1}for(;e[m];){const t=l(m);if(u.trimBeforeMatching&&""===e[m].trim()){if(!e[t]&&o&&"EOL"===r)return!0;m=l(m);continue}if(u&&!u.i&&u.trimCharsBeforeMatching&&u.trimCharsBeforeMatching.includes(e[m])||u&&u.i&&u.trimCharsBeforeMatching&&u.trimCharsBeforeMatching.map((e=>e.toLowerCase())).includes(e[m].toLowerCase())){if(o&&"EOL"===r&&!e[t])return!0;m=l(m);continue}const n=t>m?r[r.length-c]:r[c-1];if(!u.i&&e[m]===n||u.i&&e[m].toLowerCase()===n.toLowerCase()){if(y||(y=!0),p||(p=!0),c===r.length){if(T=!0,d!==u.maxMismatches)return!1}else 1===c&&(v=!0);if(c-=1,f++,b())return!1;if(!c)return(f!==r.length||d===u.maxMismatches||!h)&&m}else{if(h||f||(h=!0),!(u.maxMismatches&&d&&m))return!(0!==m||1!==c||u.lastMustMatch||!p)&&0;d-=1;for(let n=0;n<=d;n++){const i=t>m?r[r.length-c+1+n]:r[c-2-n],s=e[l(m)];if(i&&(!u.i&&e[m]===i||u.i&&e[m].toLowerCase()===i.toLowerCase())&&(!u.firstMustMatch||c!==r.length)){if(f++,b())return!1;c-=2,y=!0;break}if(s&&i&&(!u.i&&s===i||u.i&&s.toLowerCase()===i.toLowerCase())&&(!u.firstMustMatch||c!==r.length)){if(!f&&!u.hungry)return!1;c-=1,y=!0;break}if(void 0===i&&d>=0&&y&&(!u.firstMustMatch||T)&&(!u.lastMustMatch||v))return m}y||(g=m)}if(!1!==g&&g!==m&&(g=!1),c<1)return m;m=l(m)}return c>0?!(!o||"EOL"!==a)||!!(u&&u.maxMismatches>=c&&p)&&(g||0):void 0}function o(e,i,o,l,a){if(t(a)&&Object.prototype.hasOwnProperty.call(a,"trimBeforeMatching")&&"boolean"!=typeof a.trimBeforeMatching)throw new Error(`string-match-left-right/${e}(): [THROW_ID_09] opts.trimBeforeMatching should be boolean!${Array.isArray(a.trimBeforeMatching)?" Did you mean to use opts.trimCharsBeforeMatching?":""}`);const u={...n,...a};var c;if("string"==typeof u.trimCharsBeforeMatching&&(u.trimCharsBeforeMatching="string"==typeof(c=u.trimCharsBeforeMatching)?c.length?[c]:[]:c),u.trimCharsBeforeMatching=u.trimCharsBeforeMatching.map((e=>r(e)?e:String(e))),!r(i))return!1;if(!i.length)return!1;if(!Number.isInteger(o)||o<0)throw new Error(`string-match-left-right/${e}(): [THROW_ID_03] the second argument should be a natural number. Currently it's of a type: ${typeof o}, equal to:\n${JSON.stringify(o,null,4)}`);let f,h;if(r(l))f=[l];else if(Array.isArray(l))f=l;else if(l){if("function"!=typeof l)throw new Error(`string-match-left-right/${e}(): [THROW_ID_05] the third argument, whatToMatch, is neither string nor array of strings! It's ${typeof l}, equal to:\n${JSON.stringify(l,null,4)}`);f=[],f.push(l)}else f=l;if(a&&!t(a))throw new Error(`string-match-left-right/${e}(): [THROW_ID_06] the fourth argument, options object, should be a plain object. Currently it's of a type "${typeof a}", and equal to:\n${JSON.stringify(a,null,4)}`);let g=0,p="";if(u&&u.trimCharsBeforeMatching&&u.trimCharsBeforeMatching.some(((e,t)=>e.length>1&&(g=t,p=e,!0))))throw new Error(`string-match-left-right/${e}(): [THROW_ID_07] the fourth argument, options object contains trimCharsBeforeMatching. It was meant to list the single characters but one of the entries at index ${g} is longer than 1 character, ${p.length} (equals to ${p}). Please split it into separate characters and put into array as separate elements.`);if(!f||!Array.isArray(f)||Array.isArray(f)&&!f.length||Array.isArray(f)&&1===f.length&&r(f[0])&&!f[0].trim()){if("function"==typeof u.cb){let t,r=o;if("matchLeftIncl"!==e&&"matchRight"!==e||(r+=1),"L"===e[5])for(let e=r;e--;){const r=i[e];if((!u.trimBeforeMatching||u.trimBeforeMatching&&void 0!==r&&r.trim())&&(!u.trimCharsBeforeMatching||!u.trimCharsBeforeMatching.length||void 0!==r&&!u.trimCharsBeforeMatching.includes(r))){t=e;break}}else if(e.startsWith("matchRight"))for(let e=r;e<i.length;e++){const r=i[e];if((!u.trimBeforeMatching||u.trimBeforeMatching&&r.trim())&&(!u.trimCharsBeforeMatching||!u.trimCharsBeforeMatching.length||!u.trimCharsBeforeMatching.includes(r))){t=e;break}}if(void 0===t)return!1;const n=i[t],s=t+1;let l="";return s&&s>0&&(l=i.slice(0,s)),"L"===e[5]?u.cb(n,l,t):(t&&t>0&&(l=i.slice(t)),u.cb(n,l,t))}let t="";throw a||(t=" More so, the whole options object, the fourth input argument, is missing!"),new Error(`string-match-left-right/${e}(): [THROW_ID_08] the third argument, "whatToMatch", was given as an empty string. This means, you intend to match purely by a callback. The callback was not set though, the opts key "cb" is not set!${t}`)}for(let t=0,r=f.length;t<r;t++){h="function"==typeof f[t];const r=f[t];let n,l,a="",c=o;"matchRight"===e?c+=1:"matchLeft"===e&&(c-=1);const g=s(i,c,r,u,h,(t=>"L"===e[5]?t-1:t+1));if(g&&h&&"function"==typeof r&&"EOL"===r())return!(!r()||u.cb&&!u.cb(n,a,l))&&r();if(Number.isInteger(g)&&(l=e.startsWith("matchLeft")?g-1:g+1,a="L"===e[5]?i.slice(0,g):i.slice(l)),l<0&&(l=void 0),i[l]&&(n=i[l]),Number.isInteger(g)&&(!u.cb||u.cb(n,a,l)))return r}return!1}function l(e,t,r,n){return o("matchLeft",e,t,r,n)}function a(e,t,r,n){return o("matchRightIncl",e,t,r,n)}function u(e,t,r,n){return o("matchRight",e,t,r,n)}
/**
 * @name regex-empty-conditional-comments
 * @fileoverview Regular expression for matching HTML empty conditional comments
 * @version 2.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/regex-empty-conditional-comments/}
 */var c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};Function.prototype.toString.call(Object);var f={exports:{}};!function(e,t){var r="__lodash_hash_undefined__",n=9007199254740991,i="[object Arguments]",s="[object Boolean]",o="[object Date]",l="[object Function]",a="[object GeneratorFunction]",u="[object Map]",f="[object Number]",h="[object Object]",g="[object Promise]",p="[object RegExp]",d="[object Set]",m="[object String]",y="[object Symbol]",T="[object WeakMap]",v="[object ArrayBuffer]",b="[object DataView]",_="[object Float32Array]",w="[object Float64Array]",O="[object Int8Array]",S="[object Int16Array]",A="[object Int32Array]",I="[object Uint8Array]",C="[object Uint8ClampedArray]",L="[object Uint16Array]",$="[object Uint32Array]",M=/\w*$/,R=/^\[object .+?Constructor\]$/,W=/^(?:0|[1-9]\d*)$/,j={};j[i]=j["[object Array]"]=j[v]=j[b]=j[s]=j[o]=j[_]=j[w]=j[O]=j[S]=j[A]=j[u]=j[f]=j[h]=j[p]=j[d]=j[m]=j[y]=j[I]=j[C]=j[L]=j[$]=!0,j["[object Error]"]=j[l]=j[T]=!1;var F="object"==typeof self&&self&&self.Object===Object&&self,x="object"==typeof c&&c&&c.Object===Object&&c||F||Function("return this")(),k=t&&!t.nodeType&&t,E=k&&e&&!e.nodeType&&e,H=E&&E.exports===k;function N(e,t){return e.set(t[0],t[1]),e}function P(e,t){return e.add(t),e}function B(e,t,r,n){var i=-1,s=e?e.length:0;for(n&&s&&(r=e[++i]);++i<s;)r=t(r,e[i],i,e);return r}function D(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function J(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function q(e,t){return function(r){return e(t(r))}}function z(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var U,G=Array.prototype,V=Function.prototype,Z=Object.prototype,Y=x["__core-js_shared__"],K=(U=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+U:"",Q=V.toString,X=Z.hasOwnProperty,ee=Z.toString,te=RegExp("^"+Q.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),re=H?x.Buffer:void 0,ne=x.Symbol,ie=x.Uint8Array,se=q(Object.getPrototypeOf,Object),oe=Object.create,le=Z.propertyIsEnumerable,ae=G.splice,ue=Object.getOwnPropertySymbols,ce=re?re.isBuffer:void 0,fe=q(Object.keys,Object),he=Ee(x,"DataView"),ge=Ee(x,"Map"),pe=Ee(x,"Promise"),de=Ee(x,"Set"),me=Ee(x,"WeakMap"),ye=Ee(Object,"create"),Te=De(he),ve=De(ge),be=De(pe),_e=De(de),we=De(me),Oe=ne?ne.prototype:void 0,Se=Oe?Oe.valueOf:void 0;function Ae(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ie(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ce(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Le(e){this.__data__=new Ie(e)}function $e(e,t){var r=qe(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&ze(e)}(e)&&X.call(e,"callee")&&(!le.call(e,"callee")||ee.call(e)==i)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,s=!!n;for(var o in e)!t&&!X.call(e,o)||s&&("length"==o||Pe(o,n))||r.push(o);return r}function Me(e,t,r){var n=e[t];X.call(e,t)&&Je(n,r)&&(void 0!==r||t in e)||(e[t]=r)}function Re(e,t){for(var r=e.length;r--;)if(Je(e[r][0],t))return r;return-1}function We(e,t,r,n,c,g,T){var R;if(n&&(R=g?n(e,c,g,T):n(e)),void 0!==R)return R;if(!Ve(e))return e;var W=qe(e);if(W){if(R=function(e){var t=e.length,r=e.constructor(t);t&&"string"==typeof e[0]&&X.call(e,"index")&&(r.index=e.index,r.input=e.input);return r}(e),!t)return function(e,t){var r=-1,n=e.length;t||(t=Array(n));for(;++r<n;)t[r]=e[r];return t}(e,R)}else{var F=Ne(e),x=F==l||F==a;if(Ue(e))return function(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}(e,t);if(F==h||F==i||x&&!g){if(D(e))return g?e:{};if(R=function(e){return"function"!=typeof e.constructor||Be(e)?{}:(t=se(e),Ve(t)?oe(t):{});var t}(x?{}:e),!t)return function(e,t){return xe(e,He(e),t)}(e,function(e,t){return e&&xe(t,Ze(t),e)}(R,e))}else{if(!j[F])return g?e:{};R=function(e,t,r,n){var i=e.constructor;switch(t){case v:return Fe(e);case s:case o:return new i(+e);case b:return function(e,t){var r=t?Fe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,n);case _:case w:case O:case S:case A:case I:case C:case L:case $:return function(e,t){var r=t?Fe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,n);case u:return function(e,t,r){return B(t?r(J(e),!0):J(e),N,new e.constructor)}(e,n,r);case f:case m:return new i(e);case p:return function(e){var t=new e.constructor(e.source,M.exec(e));return t.lastIndex=e.lastIndex,t}(e);case d:return function(e,t,r){return B(t?r(z(e),!0):z(e),P,new e.constructor)}(e,n,r);case y:return l=e,Se?Object(Se.call(l)):{}}var l}(e,F,We,t)}}T||(T=new Le);var k=T.get(e);if(k)return k;if(T.set(e,R),!W)var E=r?function(e){return function(e,t,r){var n=t(e);return qe(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,Ze,He)}(e):Ze(e);return function(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r,e););}(E||e,(function(i,s){E&&(i=e[s=i]),Me(R,s,We(i,t,r,n,s,e,T))})),R}function je(e){return!(!Ve(e)||(t=e,K&&K in t))&&(Ge(e)||D(e)?te:R).test(De(e));var t}function Fe(e){var t=new e.constructor(e.byteLength);return new ie(t).set(new ie(e)),t}function xe(e,t,r,n){r||(r={});for(var i=-1,s=t.length;++i<s;){var o=t[i],l=n?n(r[o],e[o],o,r,e):void 0;Me(r,o,void 0===l?e[o]:l)}return r}function ke(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Ee(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return je(r)?r:void 0}Ae.prototype.clear=function(){this.__data__=ye?ye(null):{}},Ae.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Ae.prototype.get=function(e){var t=this.__data__;if(ye){var n=t[e];return n===r?void 0:n}return X.call(t,e)?t[e]:void 0},Ae.prototype.has=function(e){var t=this.__data__;return ye?void 0!==t[e]:X.call(t,e)},Ae.prototype.set=function(e,t){return this.__data__[e]=ye&&void 0===t?r:t,this},Ie.prototype.clear=function(){this.__data__=[]},Ie.prototype.delete=function(e){var t=this.__data__,r=Re(t,e);return!(r<0)&&(r==t.length-1?t.pop():ae.call(t,r,1),!0)},Ie.prototype.get=function(e){var t=this.__data__,r=Re(t,e);return r<0?void 0:t[r][1]},Ie.prototype.has=function(e){return Re(this.__data__,e)>-1},Ie.prototype.set=function(e,t){var r=this.__data__,n=Re(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},Ce.prototype.clear=function(){this.__data__={hash:new Ae,map:new(ge||Ie),string:new Ae}},Ce.prototype.delete=function(e){return ke(this,e).delete(e)},Ce.prototype.get=function(e){return ke(this,e).get(e)},Ce.prototype.has=function(e){return ke(this,e).has(e)},Ce.prototype.set=function(e,t){return ke(this,e).set(e,t),this},Le.prototype.clear=function(){this.__data__=new Ie},Le.prototype.delete=function(e){return this.__data__.delete(e)},Le.prototype.get=function(e){return this.__data__.get(e)},Le.prototype.has=function(e){return this.__data__.has(e)},Le.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Ie){var n=r.__data__;if(!ge||n.length<199)return n.push([e,t]),this;r=this.__data__=new Ce(n)}return r.set(e,t),this};var He=ue?q(ue,Object):function(){return[]},Ne=function(e){return ee.call(e)};function Pe(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||W.test(e))&&e>-1&&e%1==0&&e<t}function Be(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Z)}function De(e){if(null!=e){try{return Q.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Je(e,t){return e===t||e!=e&&t!=t}(he&&Ne(new he(new ArrayBuffer(1)))!=b||ge&&Ne(new ge)!=u||pe&&Ne(pe.resolve())!=g||de&&Ne(new de)!=d||me&&Ne(new me)!=T)&&(Ne=function(e){var t=ee.call(e),r=t==h?e.constructor:void 0,n=r?De(r):void 0;if(n)switch(n){case Te:return b;case ve:return u;case be:return g;case _e:return d;case we:return T}return t});var qe=Array.isArray;function ze(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}(e.length)&&!Ge(e)}var Ue=ce||function(){return!1};function Ge(e){var t=Ve(e)?ee.call(e):"";return t==l||t==a}function Ve(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Ze(e){return ze(e)?$e(e):function(e){if(!Be(e))return fe(e);var t=[];for(var r in Object(e))X.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}e.exports=function(e){return We(e,!0,!0)}}(f,f.exports);
/**
 * @name string-left-right
 * @fileoverview Looks up the first non-whitespace character to the left/right of a given index
 * @version 5.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-left-right/}
 */
const h=" ";function g(e,t=0){return function({str:e,idx:t=0,stopAtNewlines:r=!1,stopAtRawNbsp:n=!1}){if("string"!=typeof e||!e.length)return null;if(t&&"number"==typeof t||(t=0),!e[t+1])return null;if(e[t+1]&&(e[t+1].trim()||r&&"\n\r".includes(e[t+1])||n&&e[t+1]===h))return t+1;if(e[t+2]&&(e[t+2].trim()||r&&"\n\r".includes(e[t+2])||n&&e[t+2]===h))return t+2;for(let i=t+1,s=e.length;i<s;i++)if(e[i].trim()||r&&"\n\r".includes(e[i])||n&&e[i]===h)return i;return null}({str:e,idx:t,stopAtNewlines:!1,stopAtRawNbsp:!1})}function p(e,t=0){return function({str:e,idx:t,stopAtNewlines:r,stopAtRawNbsp:n}){if("string"!=typeof e||!e.length)return null;if(t&&"number"==typeof t||(t=0),t<1)return null;if(e[~-t]&&(e[~-t].trim()||r&&"\n\r".includes(e[~-t])||n&&e[~-t]===h))return~-t;if(e[t-2]&&(e[t-2].trim()||r&&"\n\r".includes(e[t-2])||n&&e[t-2]===h))return t-2;for(let i=t;i--;)if(e[i]&&(e[i].trim()||r&&"\n\r".includes(e[i])||n&&e[i]===h))return i;return null}({str:e,idx:t,stopAtNewlines:!1,stopAtRawNbsp:!1})}
/**
 * @name string-extract-class-names
 * @fileoverview Extracts CSS class/id names from a string
 * @version 7.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-extract-class-names/}
 */function d(e){if("string"!=typeof e)throw new TypeError(`string-extract-class-names: [THROW_ID_01] first str should be string, not ${typeof e}, currently equal to ${JSON.stringify(e,null,4)}`);const t=".# ~\\!@$%^&*()+=,/';:\"?><[]{}|`";let r;function n(e){return"string"==typeof e&&!!e.length&&(e.charCodeAt(0)>64&&e.charCodeAt(0)<91||e.charCodeAt(0)>96&&e.charCodeAt(0)<123)}let i=null;const s={res:[],ranges:[]};for(let o=0,l=e.length;o<=l;o++){null!==i&&o>=i&&(!e[o]||!e[o].trim()||t.includes(e[o]))&&(o>i+1&&(s.ranges.push([i,o]),s.res.push(`${r||""}${e.slice(i,o)}`),r&&(r=void 0)),i=null),!e[o]||null!==i||"."!==e[o]&&"#"!==e[o]||(i=o);const l=g(e,o+4);e.startsWith("class",o)&&"number"==typeof p(e,o)&&"["===e[p(e,o)]&&"number"==typeof l&&"="===e[l]&&(g(e,l)&&n(e[g(e,l)])?i=g(e,l):"'\"".includes(e[g(e,l)])&&n(e[g(e,g(e,l))])&&(i=g(e,g(e,l))),r=".");const a=g(e,o+1);e.startsWith("id",o)&&"["===e[p(e,o)]&&null!==a&&"="===e[a]&&(n(e[g(e,a)])?i=g(e,a):"'\"".includes(e[g(e,a)])&&n(e[g(e,g(e,a))])&&(i=g(e,g(e,a))),r="#")}return s.ranges.length||(s.ranges=null),s}const m=new Map,y=(e,t)=>{if(!Array.isArray(e))switch(typeof e){case"string":e=[e];break;case"undefined":e=[];break;default:throw new TypeError(`Expected '${t}' to be a string or an array, but got a type of '${typeof e}'`)}return e.filter((e=>{if("string"!=typeof e){if(void 0===e)return!1;throw new TypeError(`Expected '${t}' to be an array of strings, but found a type of '${typeof e}' in the array`)}return!0}))},T=(e,t)=>{t={caseSensitive:!1,...t};const r=e+JSON.stringify(t);if(m.has(r))return m.get(r);const n="!"===e[0];n&&(e=e.slice(1)),e=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(e).replace(/\\\*/g,"[\\s\\S]*");const i=new RegExp(`^${e}$`,t.caseSensitive?"":"i");return i.negated=n,m.set(r,i),i},v=(e,t,r,n)=>{if(e=y(e,"inputs"),0===(t=y(t,"patterns")).length)return[];t=t.map((e=>T(e,r)));const{allPatterns:i}=r||{},s=[];for(const r of e){let e;const o=[...t].fill(!1);for(const[n,i]of t.entries())if(i.test(r)&&(o[n]=!0,e=!i.negated,!e))break;if(!(!1===e||void 0===e&&t.some((e=>!e.negated))||i&&o.some(((e,r)=>!e&&!t[r].negated)))&&(s.push(r),n))break}return s};function b(e,t,r){return v(e,t,r,!1)}function _(e,t,r){return v(e,t,r,!0).length>0}
/**
 * @name array-pull-all-with-glob
 * @fileoverview Like _.pullAll but with globs (wildcards)
 * @version 6.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/array-pull-all-with-glob/}
 */function w(e,t,r){if(!e.length)return[];if(!e.length||!t.length)return Array.from(e);const n="string"==typeof t?[t]:Array.from(t),i={caseSensitive:!0,...r};return Array.from(e).filter((e=>!n.some((t=>_(e,t,{caseSensitive:i.caseSensitive})))))}var O="__lodash_hash_undefined__",S=9007199254740991,A=/^\[object .+?Constructor\]$/,I="object"==typeof self&&self&&self.Object===Object&&self,C="object"==typeof c&&c&&c.Object===Object&&c||I||Function("return this")();function L(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function $(e,t){return!!(e?e.length:0)&&function(e,t,r){if(t!=t)return function(e,t,r,n){var i=e.length,s=r+(n?1:-1);for(;n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}(e,W,r);var n=r-1,i=e.length;for(;++n<i;)if(e[n]===t)return n;return-1}(e,t,0)>-1}function M(e,t,r){for(var n=-1,i=e?e.length:0;++n<i;)if(r(t,e[n]))return!0;return!1}function R(e,t){for(var r=-1,n=e?e.length:0,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}function W(e){return e!=e}function j(e){return function(t){return e(t)}}function F(e,t){return e.has(t)}var x,k=Array.prototype,E=Function.prototype,H=Object.prototype,N=C["__core-js_shared__"],P=(x=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||""))?"Symbol(src)_1."+x:"",B=E.toString,D=H.hasOwnProperty,J=H.toString,q=RegExp("^"+B.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),z=k.splice,U=Math.max,G=Math.min,V=ie(C,"Map"),Z=ie(Object,"create");function Y(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function K(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Q(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function X(e){var t=-1,r=e?e.length:0;for(this.__data__=new Q;++t<r;)this.add(e[t])}function ee(e,t){for(var r,n,i=e.length;i--;)if((r=e[i][0])===(n=t)||r!=r&&n!=n)return i;return-1}function te(e){if(!ue(e)||(t=e,P&&P in t))return!1;var t,r=ae(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?q:A;return r.test(function(e){if(null!=e){try{return B.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function re(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=S}(e.length)&&!ae(e)}(e)}(e)?e:[]}function ne(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function ie(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return te(r)?r:void 0}Y.prototype.clear=function(){this.__data__=Z?Z(null):{}},Y.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Y.prototype.get=function(e){var t=this.__data__;if(Z){var r=t[e];return r===O?void 0:r}return D.call(t,e)?t[e]:void 0},Y.prototype.has=function(e){var t=this.__data__;return Z?void 0!==t[e]:D.call(t,e)},Y.prototype.set=function(e,t){return this.__data__[e]=Z&&void 0===t?O:t,this},K.prototype.clear=function(){this.__data__=[]},K.prototype.delete=function(e){var t=this.__data__,r=ee(t,e);return!(r<0)&&(r==t.length-1?t.pop():z.call(t,r,1),!0)},K.prototype.get=function(e){var t=this.__data__,r=ee(t,e);return r<0?void 0:t[r][1]},K.prototype.has=function(e){return ee(this.__data__,e)>-1},K.prototype.set=function(e,t){var r=this.__data__,n=ee(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},Q.prototype.clear=function(){this.__data__={hash:new Y,map:new(V||K),string:new Y}},Q.prototype.delete=function(e){return ne(this,e).delete(e)},Q.prototype.get=function(e){return ne(this,e).get(e)},Q.prototype.has=function(e){return ne(this,e).has(e)},Q.prototype.set=function(e,t){return ne(this,e).set(e,t),this},X.prototype.add=X.prototype.push=function(e){return this.__data__.set(e,O),this},X.prototype.has=function(e){return this.__data__.has(e)};var se,oe,le=(se=function(e){var t=R(e,re);return t.length&&t[0]===e[0]?function(e,t,r){for(var n=r?M:$,i=e[0].length,s=e.length,o=s,l=Array(s),a=1/0,u=[];o--;){var c=e[o];o&&t&&(c=R(c,j(t))),a=G(c.length,a),l[o]=!r&&(t||i>=120&&c.length>=120)?new X(o&&c):void 0}c=e[0];var f=-1,h=l[0];e:for(;++f<i&&u.length<a;){var g=c[f],p=t?t(g):g;if(g=r||0!==g?g:0,!(h?F(h,p):n(u,p,r))){for(o=s;--o;){var d=l[o];if(!(d?F(d,p):n(e[o],p,r)))continue e}h&&h.push(p),u.push(g)}}return u}(t):[]},oe=U(void 0===oe?se.length-1:oe,0),function(){for(var e=arguments,t=-1,r=U(e.length-oe,0),n=Array(r);++t<r;)n[t]=e[oe+t];t=-1;for(var i=Array(oe+1);++t<oe;)i[t]=e[t];return i[oe]=n,L(se,this,i)});function ae(e){var t=ue(e)?J.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function ue(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var ce=le;
/**
 * @name string-range-expander
 * @fileoverview Expands string index ranges within whitespace boundaries until letters are met
 * @version 3.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-range-expander/}
 */const fe={str:"",from:0,to:0,ifLeftSideIncludesThisThenCropTightly:"",ifLeftSideIncludesThisCropItToo:"",ifRightSideIncludesThisThenCropTightly:"",ifRightSideIncludesThisCropItToo:"",extendToOneSide:!1,wipeAllWhitespaceOnLeft:!1,wipeAllWhitespaceOnRight:!1,addSingleSpaceToPreventAccidentalConcatenation:!1};function he(e){const t=/^[0-9a-zA-Z]+$/;function r(e){return!(!e||"string"!=typeof e)&&!e.trim()}function n(e){return"string"==typeof e}if(!e||"object"!=typeof e||Array.isArray(e)){let t;throw t=void 0===e?"but it is missing completely.":null===e?"but it was given as null.":`but it was given as ${typeof e}, equal to:\n${JSON.stringify(e,null,4)}.`,new Error(`string-range-expander: [THROW_ID_01] Input must be a plain object ${t}`)}if("object"==typeof e&&null!==e&&!Array.isArray(e)&&!Object.keys(e).length)throw new Error("string-range-expander: [THROW_ID_02] Input must be a plain object but it was given as a plain object without any keys.");if("number"!=typeof e.from)throw new Error(`string-range-expander: [THROW_ID_03] The input's "from" value opts.from, is not a number! Currently it's given as ${typeof e.from}, equal to ${JSON.stringify(e.from,null,0)}`);if("number"!=typeof e.to)throw new Error(`string-range-expander: [THROW_ID_04] The input's "to" value opts.to, is not a number! Currently it's given as ${typeof e.to}, equal to ${JSON.stringify(e.to,null,0)}`);if(e&&e.str&&!e.str[e.from]&&e.from!==e.to)throw new Error(`string-range-expander: [THROW_ID_05] The given input string opts.str ("${e.str}") must contain the character at index "from" ("${e.from}")`);if(e&&e.str&&!e.str[e.to-1])throw new Error(`string-range-expander: [THROW_ID_06] The given input string, opts.str ("${e.str}") must contain the character at index before "to" ("${e.to-1}")`);if(e.from>e.to)throw new Error(`string-range-expander: [THROW_ID_07] The given "from" index, "${e.from}" is greater than "to" index, "${e.to}". That's wrong!`);if(n(e.extendToOneSide)&&"left"!==e.extendToOneSide&&"right"!==e.extendToOneSide||!n(e.extendToOneSide)&&void 0!==e.extendToOneSide&&!1!==e.extendToOneSide)throw new Error(`string-range-expander: [THROW_ID_08] The opts.extendToOneSide value is not recogniseable! It's set to: "${e.extendToOneSide}" (${typeof e.extendToOneSide}). It has to be either Boolean "false" or strings "left" or "right"`);const i={...fe,...e};if(Array.isArray(i.ifLeftSideIncludesThisThenCropTightly)){let e,t;if(!i.ifLeftSideIncludesThisThenCropTightly.every(((r,i)=>!!n(r)||(e=i,t=r,!1))))throw new Error(`string-range-expander: [THROW_ID_09] The opts.ifLeftSideIncludesThisThenCropTightly was set to an array:\n${JSON.stringify(i.ifLeftSideIncludesThisThenCropTightly,null,4)}. Now, that array contains not only string elements. For example, an element at index ${e} is of a type ${typeof t} (equal to ${JSON.stringify(t,null,0)}).`);i.ifLeftSideIncludesThisThenCropTightly=i.ifLeftSideIncludesThisThenCropTightly.join("")}const s=i.str;let o=i.from,l=i.to;if("right"!==i.extendToOneSide&&(r(s[o-1])&&(r(s[o-2])||i.ifLeftSideIncludesThisCropItToo.includes(s[o-2]))||s[o-1]&&i.ifLeftSideIncludesThisCropItToo.includes(s[o-1])||i.wipeAllWhitespaceOnLeft&&r(s[o-1])))for(let e=o;e--;)if(!i.ifLeftSideIncludesThisCropItToo.includes(s[e])){if(s[e].trim()){o=i.wipeAllWhitespaceOnLeft||i.ifLeftSideIncludesThisCropItToo.includes(s[e+1])?e+1:e+2;break}if(0===e){o=i.wipeAllWhitespaceOnLeft?0:1;break}}if("left"!==i.extendToOneSide&&(r(s[l])&&(i.wipeAllWhitespaceOnRight||r(s[l+1]))||i.ifRightSideIncludesThisCropItToo.includes(s[l])))for(let e=l,t=s.length;e<t;e++)if(!i.ifRightSideIncludesThisCropItToo.includes(s[e])&&(s[e]&&s[e].trim()||void 0===s[e])){l=i.wipeAllWhitespaceOnRight||i.ifRightSideIncludesThisCropItToo.includes(s[e-1])?e:e-1;break}return("right"!==i.extendToOneSide&&n(i.ifLeftSideIncludesThisThenCropTightly)&&i.ifLeftSideIncludesThisThenCropTightly&&(s[o-2]&&i.ifLeftSideIncludesThisThenCropTightly.includes(s[o-2])||s[o-1]&&i.ifLeftSideIncludesThisThenCropTightly.includes(s[o-1]))||"left"!==i.extendToOneSide&&n(i.ifRightSideIncludesThisThenCropTightly)&&i.ifRightSideIncludesThisThenCropTightly&&(s[l+1]&&i.ifRightSideIncludesThisThenCropTightly.includes(s[l+1])||s[l]&&i.ifRightSideIncludesThisThenCropTightly.includes(s[l])))&&("right"!==i.extendToOneSide&&r(s[o-1])&&!i.wipeAllWhitespaceOnLeft&&(o-=1),"left"!==i.extendToOneSide&&r(s[l])&&!i.wipeAllWhitespaceOnRight&&(l+=1)),i.addSingleSpaceToPreventAccidentalConcatenation&&s[o-1]&&s[o-1].trim()&&s[l]&&s[l].trim()&&(!i.ifLeftSideIncludesThisThenCropTightly&&!i.ifRightSideIncludesThisThenCropTightly||i.ifLeftSideIncludesThisThenCropTightly&&!i.ifLeftSideIncludesThisThenCropTightly.includes(s[o-1])||!(!i.ifRightSideIncludesThisThenCropTightly||s[l]&&i.ifRightSideIncludesThisThenCropTightly.includes(s[l])))&&(t.test(s[o-1])||t.test(s[l]))?[o,l," "]:[o,l]}
/**
 * @name string-uglify
 * @fileoverview Shorten sets of strings deterministically, to be git-friendly
 * @version 2.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-uglify/}
 */function ge(e,t=0){return e.codePointAt(t)||0}function pe(e){const t="abcdefghijklmnopqrstuvwxyz",r="abcdefghijklmnopqrstuvwxyz0123456789",n={a:!1,b:!1,c:!1,d:!1,e:!1,f:!1,g:!1,h:!1,i:!1,j:!1,k:!1,l:!1,m:!1,n:!1,o:!1,p:!1,q:!1,r:!1,s:!1,t:!1,u:!1,v:!1,w:!1,x:!1,y:!1,z:!1},i={a:!1,b:!1,c:!1,d:!1,e:!1,f:!1,g:!1,h:!1,i:!1,j:!1,k:!1,l:!1,m:!1,n:!1,o:!1,p:!1,q:!1,r:!1,s:!1,t:!1,u:!1,v:!1,w:!1,x:!1,y:!1,z:!1},s={a:!1,b:!1,c:!1,d:!1,e:!1,f:!1,g:!1,h:!1,i:!1,j:!1,k:!1,l:!1,m:!1,n:!1,o:!1,p:!1,q:!1,r:!1,s:!1,t:!1,u:!1,v:!1,w:!1,x:!1,y:!1,z:!1},o=[];if(!Array.isArray(e)||!e.length)return e;for(let l=0,a=e.length;l<a;l++){if(e.indexOf(e[l])<l){o.push(o[e.indexOf(e[l])]);continue}const a=".#".includes(e[l][0])?e[l][0]:"",u=Array.from(e[l]).reduce(((e,t)=>e+ge(t)),0);if(".#".includes(e[l][0])&&e[l].length<4||!".#".includes(e[l][0])&&e[l].length<3){const t=e[l];if(!o.includes(t)){o.push(t),t.startsWith(".")&&2===t.length&&!1===n[t.slice(1)]?n[t.slice(1)]=!0:t.startsWith("#")&&2===t.length&&!1===i[t.slice(1)]?i[t.slice(1)]=!0:t.startsWith(".")||t.startsWith("#")||1!==t.length||!1!==s[t]||(s[t]=!0);continue}}let c=`${a}${t[u%t.length]}${r[u%r.length]}`;if(o.includes(c)){let t=c,n=0;const i=Array.from(e[l]).reduce(((e,t)=>e<200?e+ge(t):(e+ge(t))%r.length),0),s=Array.from(e[l]).map((e=>ge(e))).reduce(((e,t)=>{let r=e+t;do{r=String(r).split("").reduce(((e,t)=>e+Number.parseInt(t,10)),0)}while(r>=10);return r}),0);for(;o.includes(t);)n+=1,t+=r[i*s*n%r.length];c=t}o.push(c),c.startsWith(".")&&2===c.length&&!1===n[c.slice(1)]?n[c.slice(1)]=!0:c.startsWith("#")&&2===c.length&&!1===i[c.slice(1)]?i[c.slice(1)]=!0:c.startsWith(".")||c.startsWith("#")||1!==c.length||!1!==s[c]||(s[c]=!0)}for(let e=0,t=o.length;e<t;e++)o[e].startsWith(".")?!1===n[o[e].slice(1,2)]?(n[o[e].slice(1,2)]=o[e],o[e]=o[e].slice(0,2)):n[o[e].slice(1,2)]===o[e]&&(o[e]=o[e].slice(0,2)):o[e].startsWith("#")?!1===i[o[e].slice(1,2)]?(i[o[e].slice(1,2)]=o[e],o[e]=o[e].slice(0,2)):i[o[e].slice(1,2)]===o[e]&&(o[e]=o[e].slice(0,2)):o[e].startsWith(".")||o[e].startsWith("#")||(s[o[e].slice(0,1)]?s[o[e].slice(0,1)]===o[e]&&(o[e]=o[e].slice(0,1)):(s[o[e].slice(0,1)]=o[e],o[e]=o[e].slice(0,1)));return o}
/**
 * @name ranges-sort
 * @fileoverview Sort string index ranges
 * @version 5.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-sort/}
 */const de={strictlyTwoElementsInRangeArrays:!1,progressFn:null};function me(e,t){if(!Array.isArray(e)||!e.length)return e;const r={...de,...t};let n,i;if(r.strictlyTwoElementsInRangeArrays&&!e.filter((e=>e)).every(((e,t)=>2===e.length||(n=t,i=e.length,!1))))throw new TypeError(`ranges-sort: [THROW_ID_03] The first argument should be an array and must consist of arrays which are natural number indexes representing TWO string index ranges. However, ${n}th range (${JSON.stringify(e[n],null,4)}) has not two but ${i} elements!`);if(!e.filter((e=>e)).every(((e,t)=>!(!Number.isInteger(e[0])||e[0]<0||!Number.isInteger(e[1])||e[1]<0)||(n=t,!1))))throw new TypeError(`ranges-sort: [THROW_ID_04] The first argument should be an array and must consist of arrays which are natural number indexes representing string index ranges. However, ${n}th range (${JSON.stringify(e[n],null,4)}) does not consist of only natural numbers!`);const s=e.filter((e=>e)).length**2;let o=0;return Array.from(e).filter((e=>e)).sort(((e,t)=>(r.progressFn&&(o+=1,r.progressFn(Math.floor(100*o/s))),e[0]===t[0]?e[1]<t[1]?-1:e[1]>t[1]?1:0:e[0]<t[0]?-1:1)))}
/**
 * @name ranges-merge
 * @fileoverview Merge and sort string index ranges
 * @version 8.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-merge/}
 */const ye={mergeType:1,progressFn:null,joinRangesThatTouchEdges:!0};function Te(e,t){function r(e){return e&&"object"==typeof e&&!Array.isArray(e)}if(!Array.isArray(e)||!e.length)return null;let n;if(t){if(!r(t))throw new Error(`emlint: [THROW_ID_03] the second input argument must be a plain object. It was given as:\n${JSON.stringify(t,null,4)} (type ${typeof t})`);if(n={...ye,...t},n.progressFn&&r(n.progressFn)&&!Object.keys(n.progressFn).length)n.progressFn=null;else if(n.progressFn&&"function"!=typeof n.progressFn)throw new Error(`ranges-merge: [THROW_ID_01] opts.progressFn must be a function! It was given of a type: "${typeof n.progressFn}", equal to ${JSON.stringify(n.progressFn,null,4)}`);if(n.mergeType&&1!=+n.mergeType&&2!=+n.mergeType)throw new Error(`ranges-merge: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "${typeof n.mergeType}", equal to ${JSON.stringify(n.mergeType,null,4)}`);if("boolean"!=typeof n.joinRangesThatTouchEdges)throw new Error(`ranges-merge: [THROW_ID_04] opts.joinRangesThatTouchEdges was customised to a wrong thing! It was given of a type: "${typeof n.joinRangesThatTouchEdges}", equal to ${JSON.stringify(n.joinRangesThatTouchEdges,null,4)}`)}else n={...ye};const i=e.filter((e=>e)).map((e=>[...e])).filter((e=>void 0!==e[2]||e[0]!==e[1]));let s,o,l;if(s=n.progressFn?me(i,{progressFn:e=>{l=Math.floor(e/5),l!==o&&(o=l,n.progressFn(l))}}):me(i),!s)return null;const a=s.length-1;for(let e=a;e>0;e--)n.progressFn&&(l=Math.floor(78*(1-e/a))+21,l!==o&&l>o&&(o=l,n.progressFn(l))),(s[e][0]<=s[e-1][0]||!n.joinRangesThatTouchEdges&&s[e][0]<s[e-1][1]||n.joinRangesThatTouchEdges&&s[e][0]<=s[e-1][1])&&(s[e-1][0]=Math.min(s[e][0],s[e-1][0]),s[e-1][1]=Math.max(s[e][1],s[e-1][1]),void 0!==s[e][2]&&(s[e-1][0]>=s[e][0]||s[e-1][1]<=s[e][1])&&null!==s[e-1][2]&&(null===s[e][2]&&null!==s[e-1][2]?s[e-1][2]=null:null!=s[e-1][2]?2==+n.mergeType&&s[e-1][0]===s[e][0]?s[e-1][2]=s[e][2]:s[e-1][2]+=s[e][2]:s[e-1][2]=s[e][2]),s.splice(e,1),e=s.length);return s.length?s:null}
/**
 * @name ranges-apply
 * @fileoverview Take an array of string index ranges, delete/replace the string according to them
 * @version 6.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-apply/}
 */function ve(e,t,r){let n,i=0,s=0;if(0===arguments.length)throw new Error("ranges-apply: [THROW_ID_01] inputs missing!");if("string"!=typeof e)throw new TypeError(`ranges-apply: [THROW_ID_02] first input argument must be a string! Currently it's: ${typeof e}, equal to: ${JSON.stringify(e,null,4)}`);if(t&&!Array.isArray(t))throw new TypeError(`ranges-apply: [THROW_ID_03] second input argument must be an array (or null)! Currently it's: ${typeof t}, equal to: ${JSON.stringify(t,null,4)}`);if(r&&"function"!=typeof r)throw new TypeError(`ranges-apply: [THROW_ID_04] the third input argument must be a function (or falsey)! Currently it's: ${typeof r}, equal to: ${JSON.stringify(r,null,4)}`);if(!t||!t.filter((e=>e)).length)return e;n=Array.isArray(t)&&Number.isInteger(t[0])&&Number.isInteger(t[1])?[Array.from(t)]:Array.from(t);const o=n.length;let l=0;n.filter((e=>e)).forEach(((e,t)=>{if(r&&(i=Math.floor(l/o*10),i!==s&&(s=i,r(i))),!Array.isArray(e))throw new TypeError(`ranges-apply: [THROW_ID_05] ranges array, second input arg., has ${t}th element not an array: ${JSON.stringify(e,null,4)}, which is ${typeof e}`);if(!Number.isInteger(e[0])){if(!Number.isInteger(+e[0])||+e[0]<0)throw new TypeError(`ranges-apply: [THROW_ID_06] ranges array, second input arg. has ${t}th element, array ${JSON.stringify(e,null,0)}. Its first element is not an integer, string index, but ${typeof e[0]}, equal to: ${JSON.stringify(e[0],null,4)}.`);n[t][0]=+n[t][0]}if(!Number.isInteger(e[1])){if(!Number.isInteger(+e[1])||+e[1]<0)throw new TypeError(`ranges-apply: [THROW_ID_07] ranges array, second input arg. has ${t}th element, array ${JSON.stringify(e,null,0)}. Its second element is not an integer, string index, but ${typeof e[1]}, equal to: ${JSON.stringify(e[1],null,4)}.`);n[t][1]=+n[t][1]}l+=1}));const a=Te(n,{progressFn:e=>{r&&(i=10+Math.floor(e/10),i!==s&&(s=i,r(i)))}}),u=Array.isArray(a)?a.length:0;if(u>0){const t=e.slice(a[u-1][1]);e=a.reduce(((t,n,o,l)=>{r&&(i=20+Math.floor(o/u*80),i!==s&&(s=i,r(i)));return t+e.slice(0===o?0:l[o-1][1],l[o][0])+(l[o][2]||"")}),""),e+=t}return e}function be(e,t,r){if(t!=t)return function(e,t,r,n){for(var i=e.length,s=r+(n?1:-1);n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}(e,we,r);for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}function _e(e,t,r,n){for(var i=r-1,s=e.length;++i<s;)if(n(e[i],t))return i;return-1}function we(e){return e!=e}var Oe=Array.prototype.splice;function Se(e,t,r,n){var i=n?_e:be,s=-1,o=t.length,l=e;for(e===t&&(t=function(e,t){var r=-1,n=e.length;t||(t=Array(n));for(;++r<n;)t[r]=e[r];return t}(t)),r&&(l=function(e,t){for(var r=-1,n=e?e.length:0,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(e,function(e){return function(t){return e(t)}}(r)));++s<o;)for(var a=0,u=t[s],c=r?r(u):u;(a=i(l,c,a,n))>-1;)l!==e&&Oe.call(l,a,1),Oe.call(e,a,1);return e}var Ae=function(e,t){return e&&e.length&&t&&t.length?Se(e,t):e};
/**
 * @name string-collapse-leading-whitespace
 * @fileoverview Collapse the leading and trailing whitespace of a string
 * @version 6.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-collapse-leading-whitespace/}
 */function Ie(e,t=1){function r(e){return Array.from(e).reverse().join("")}function n(e,t,r){const n=r?"\n":"\r",i=r?"\r":"\n";if(!e)return e;let s=0,o="";for(let r=0,l=e.length;r<l;r++)(e[r]===n||e[r]===i&&e[r-1]!==n)&&s++,"\r\n".includes(e[r])||" "===e[r]?" "===e[r]?o+=e[r]:e[r]===n?s<=t&&(o+=e[r],e[r+1]===i&&(o+=e[r+1],r++)):e[r]===i&&(!e[r-1]||e[r-1]!==n)&&s<=t&&(o+=e[r]):e[r+1]||s||(o+=" ");return o}if("string"==typeof e&&e.length){let i=1;"number"==typeof+t&&Number.isInteger(+t)&&+t>=0&&(i=+t);let s="",o="";if(e.trim()){if(!e[0].trim())for(let t=0,r=e.length;t<r;t++)if(e[t].trim()){s=e.slice(0,t);break}}else s=e;if(e.trim()&&(""===e.slice(-1).trim()||" "===e.slice(-1)))for(let t=e.length;t--;)if(e[t].trim()){o=e.slice(t+1);break}return`${n(s,i,!1)}${e.trim()}${r(n(r(o),i,!0))}`}return e}
/**
 * @name ranges-push
 * @fileoverview Gather string index ranges
 * @version 6.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-push/}
 */const Ce={strictlyTwoElementsInRangeArrays:!1,progressFn:null};function Le(e,t){if(!Array.isArray(e)||!e.length)return e;const r={...Ce,...t};let n,i;if(r.strictlyTwoElementsInRangeArrays&&!e.filter((e=>e)).every(((e,t)=>2===e.length||(n=t,i=e.length,!1))))throw new TypeError(`ranges-sort: [THROW_ID_03] The first argument should be an array and must consist of arrays which are natural number indexes representing TWO string index ranges. However, ${n}th range (${JSON.stringify(e[n],null,4)}) has not two but ${i} elements!`);if(!e.filter((e=>e)).every(((e,t)=>!(!Number.isInteger(e[0])||e[0]<0||!Number.isInteger(e[1])||e[1]<0)||(n=t,!1))))throw new TypeError(`ranges-sort: [THROW_ID_04] The first argument should be an array and must consist of arrays which are natural number indexes representing string index ranges. However, ${n}th range (${JSON.stringify(e[n],null,4)}) does not consist of only natural numbers!`);const s=e.filter((e=>e)).length**2;let o=0;return Array.from(e).filter((e=>e)).sort(((e,t)=>(r.progressFn&&(o+=1,r.progressFn(Math.floor(100*o/s))),e[0]===t[0]?e[1]<t[1]?-1:e[1]>t[1]?1:0:e[0]<t[0]?-1:1)))}const $e={mergeType:1,progressFn:null,joinRangesThatTouchEdges:!0};function Me(e){return null!=e}function Re(e){return Number.isInteger(e)&&e>=0}function We(e){return"string"==typeof e}const je={limitToBeAddedWhitespace:!1,limitLinebreaksCount:1,mergeType:1};class Fe{constructor(e){const t={...je,...e};if(t.mergeType&&1!==t.mergeType&&2!==t.mergeType)if(We(t.mergeType)&&"1"===t.mergeType.trim())t.mergeType=1;else{if(!We(t.mergeType)||"2"!==t.mergeType.trim())throw new Error(`ranges-push: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "${typeof t.mergeType}", equal to ${JSON.stringify(t.mergeType,null,4)}`);t.mergeType=2}this.opts=t,this.ranges=[]}ranges;opts;add(e,t,r){if(null==e&&null==t)return;if(Me(e)&&!Me(t)){if(Array.isArray(e)){if(e.length){if(e.some((e=>Array.isArray(e))))return void e.forEach((e=>{Array.isArray(e)&&this.add(...e)}));e.length&&Re(+e[0])&&Re(+e[1])&&this.add(...e)}return}throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_12] the first input argument, "from" is set (${JSON.stringify(e,null,0)}) but second-one, "to" is not (${JSON.stringify(t,null,0)})`)}if(!Me(e)&&Me(t))throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_13] the second input argument, "to" is set (${JSON.stringify(t,null,0)}) but first-one, "from" is not (${JSON.stringify(e,null,0)})`);const n=+e,i=+t;if(Re(r)&&(r=String(r)),!Re(n)||!Re(i))throw Re(n)&&n>=0?new TypeError(`ranges-push/Ranges/add(): [THROW_ID_10] "to" value, the second input argument, must be a natural number or zero! Currently it's of a type "${typeof i}" equal to: ${JSON.stringify(i,null,4)}`):new TypeError(`ranges-push/Ranges/add(): [THROW_ID_09] "from" value, the first input argument, must be a natural number or zero! Currently it's of a type "${typeof n}" equal to: ${JSON.stringify(n,null,4)}`);if(Me(r)&&!We(r)&&!Re(r))throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_08] The third argument, the value to add, was given not as string but ${typeof r}, equal to:\n${JSON.stringify(r,null,4)}`);if(Me(this.ranges)&&Array.isArray(this.last())&&n===this.last()[1]){if(this.last()[1]=i,this.last(),null!==this.last()[2]&&Me(r)){let e=!(this.last()[2]&&this.last()[2].length>0)||this.opts&&this.opts.mergeType&&1!==this.opts.mergeType?r:this.last()[2]+r;this.opts.limitToBeAddedWhitespace&&(e=Ie(e,this.opts.limitLinebreaksCount)),We(e)&&!e.length||(this.last()[2]=e)}}else{this.ranges||(this.ranges=[]);const e=void 0===r||We(r)&&!r.length?[n,i]:[n,i,r&&this.opts.limitToBeAddedWhitespace?Ie(r,this.opts.limitLinebreaksCount):r];this.ranges.push(e)}}push(e,t,r){this.add(e,t,r)}current(){return Array.isArray(this.ranges)&&this.ranges.length?(this.ranges=function(e,t){function r(e){return e&&"object"==typeof e&&!Array.isArray(e)}if(!Array.isArray(e)||!e.length)return null;let n;if(t){if(!r(t))throw new Error(`emlint: [THROW_ID_03] the second input argument must be a plain object. It was given as:\n${JSON.stringify(t,null,4)} (type ${typeof t})`);if(n={...$e,...t},n.progressFn&&r(n.progressFn)&&!Object.keys(n.progressFn).length)n.progressFn=null;else if(n.progressFn&&"function"!=typeof n.progressFn)throw new Error(`ranges-merge: [THROW_ID_01] opts.progressFn must be a function! It was given of a type: "${typeof n.progressFn}", equal to ${JSON.stringify(n.progressFn,null,4)}`);if(n.mergeType&&1!=+n.mergeType&&2!=+n.mergeType)throw new Error(`ranges-merge: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "${typeof n.mergeType}", equal to ${JSON.stringify(n.mergeType,null,4)}`);if("boolean"!=typeof n.joinRangesThatTouchEdges)throw new Error(`ranges-merge: [THROW_ID_04] opts.joinRangesThatTouchEdges was customised to a wrong thing! It was given of a type: "${typeof n.joinRangesThatTouchEdges}", equal to ${JSON.stringify(n.joinRangesThatTouchEdges,null,4)}`)}else n={...$e};const i=e.filter((e=>e)).map((e=>[...e])).filter((e=>void 0!==e[2]||e[0]!==e[1]));let s,o,l;if(s=n.progressFn?Le(i,{progressFn:e=>{l=Math.floor(e/5),l!==o&&(o=l,n.progressFn(l))}}):Le(i),!s)return null;const a=s.length-1;for(let e=a;e>0;e--)n.progressFn&&(l=Math.floor(78*(1-e/a))+21,l!==o&&l>o&&(o=l,n.progressFn(l))),(s[e][0]<=s[e-1][0]||!n.joinRangesThatTouchEdges&&s[e][0]<s[e-1][1]||n.joinRangesThatTouchEdges&&s[e][0]<=s[e-1][1])&&(s[e-1][0]=Math.min(s[e][0],s[e-1][0]),s[e-1][1]=Math.max(s[e][1],s[e-1][1]),void 0!==s[e][2]&&(s[e-1][0]>=s[e][0]||s[e-1][1]<=s[e][1])&&null!==s[e-1][2]&&(null===s[e][2]&&null!==s[e-1][2]?s[e-1][2]=null:null!=s[e-1][2]?2==+n.mergeType&&s[e-1][0]===s[e][0]?s[e-1][2]=s[e][2]:s[e-1][2]+=s[e][2]:s[e-1][2]=s[e][2]),s.splice(e,1),e=s.length);return s.length?s:null}(this.ranges,{mergeType:this.opts.mergeType}),this.ranges&&this.opts.limitToBeAddedWhitespace?this.ranges.map((e=>Me(e[2])?[e[0],e[1],Ie(e[2],this.opts.limitLinebreaksCount)]:e)):this.ranges):null}wipe(){this.ranges=[]}replace(e){if(Array.isArray(e)&&e.length){if(!Array.isArray(e[0])||!Re(e[0][0]))throw new Error(`ranges-push/Ranges/replace(): [THROW_ID_11] Single range was given but we expected array of arrays! The first element, ${JSON.stringify(e[0],null,4)} should be an array and its first element should be an integer, a string index.`);this.ranges=Array.from(e)}else this.ranges=[]}last(){return Array.isArray(this.ranges)&&this.ranges.length?this.ranges[this.ranges.length-1]:null}}
/**
 * @name html-crush
 * @fileoverview Minifies HTML/CSS: valid or broken, pure or mixed with other languages
 * @version 5.0.3
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/html-crush/}
 */const xe=new Fe({limitToBeAddedWhitespace:!0}),ke={lineLengthLimit:500,removeIndentations:!0,removeLineBreaks:!1,removeHTMLComments:!1,removeCSSComments:!0,reportProgressFunc:null,reportProgressFuncFrom:0,reportProgressFuncTo:100,breakToTheLeftOf:["</td","<html","</html","<head","</head","<meta","<link","<table","<script","</script","<!DOCTYPE","<style","</style","<title","<body","@media","</body","\x3c!--[if","\x3c!--<![endif","<![endif]"],mindTheInlineTags:["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"]},Ee={removeHTMLComments:!1,removeCSSComments:!1};function He(e){return"string"==typeof e}function Ne(e){return"string"==typeof e&&e.toUpperCase()!==e.toLowerCase()}function Pe(e,t){const r=Date.now();if(!He(e))throw void 0===e?new Error("html-crush: [THROW_ID_01] the first input argument is completely missing! It should be given as string."):new Error(`html-crush: [THROW_ID_02] the first input argument must be string! It was given as "${typeof e}", equal to:\n${JSON.stringify(e,null,4)}`);if(t&&"object"!=typeof t)throw new Error(`html-crush: [THROW_ID_03] the second input argument, options object, should be a plain object but it was given as type ${typeof t}, equal to ${JSON.stringify(t,null,4)}`);if(t&&Array.isArray(t.breakToTheLeftOf)&&t.breakToTheLeftOf.length)for(let e=0,r=t.breakToTheLeftOf.length;e<r;e++)if(!He(t.breakToTheLeftOf[e]))throw new TypeError(`html-crush: [THROW_ID_05] the opts.breakToTheLeftOf array contains non-string elements! For example, element at index ${e} is of a type "${typeof t.breakToTheLeftOf[e]}" and is equal to:\n${JSON.stringify(t.breakToTheLeftOf[e],null,4)}`);const n={...ke,...t};"boolean"==typeof n.removeHTMLComments&&(n.removeHTMLComments=n.removeHTMLComments?1:0);let i="";Array.isArray(n.breakToTheLeftOf)&&n.breakToTheLeftOf.length&&(i=[...new Set(n.breakToTheLeftOf.map((e=>e[0])))].join(""));let s,o=null,c=null,f=!1,h=0,d=0,m=!1,y=!1,T=null,v=null,b=null,_=null,w=null,O=null,S=null,A=null,I=null,C=null;const L=">};",$="<",M="!",R=">",W="<",j="{},:;<>~+",F=j,x=j;let k=!0;const E=e.length,H=Math.floor(E/2);let N,P;n.reportProgressFunc&&(N=Math.floor(n.reportProgressFuncTo-.01*(n.reportProgressFuncTo-n.reportProgressFuncFrom)-n.reportProgressFuncFrom));let B=0,D="\n";if(e.includes("\r\n")?D="\r\n":e.includes("\r")&&(D="\r"),E){for(let t=0;t<E;t++)if(n.reportProgressFunc&&(E>1e3&&E<2e3?t===H&&n.reportProgressFunc(Math.floor((n.reportProgressFuncTo-n.reportProgressFuncFrom)/2)):E>=2e3&&(P=n.reportProgressFuncFrom+Math.floor(t/E*(N||1)),P!==B&&(B=P,n.reportProgressFunc(P)))),d++,!s&&m&&"}"===e[t]&&"}"===e[t-1]&&(h+1>=n.lineLengthLimit?(xe.push(t,t,D),h=0):(w=t,O=t,S=" ")),s&&"number"==typeof s&&t>=s&&(s=void 0),null===_||!e.startsWith("</script",t)||Ne(e[t+8])){if(!s&&!m&&e.startsWith("<script",t)&&!Ne(e[t+7])){_=t,s=!0;let e="";(n.removeLineBreaks||n.removeIndentations)&&null!==c&&(c>0&&(e=D),xe.push(c,t,e)),c=null,o=null}if(null!==I&&null===A&&!/\w/.test(e[t])){A=e.slice(I,t);const r=g(e,~-t);"number"==typeof r&&">"===e[r]&&!e[t].trim()&&g(e,t)?xe.push(t,g(e,t)):r&&"/"===e[r]&&">"===e[g(e,r)]&&(!e[t].trim()&&g(e,t)&&xe.push(t,g(e,t)),">"!==e[r+1]&&g(e,r+1)&&xe.push(r+1,g(e,r+1)))}if(s||m||T||"<"!==e[~-t]||null!==I||(/\w/.test(e[t])?I=t:"/"===e[g(e,~-t)]&&/\w/.test(e[g(e,g(e,~-t))]||"")&&(I=g(e,g(e,~-t)))),s||!m&&!T||null===v||"*"!==e[t]||"/"!==e[t+1]||([w,O]=he({str:e,from:v,to:t+2,ifLeftSideIncludesThisThenCropTightly:F,ifRightSideIncludesThisThenCropTightly:x}),v=null,null!=w?xe.push(w,O):(h+=1,t+=1),s=t+2),s||!m&&!T||null!==v||"/"!==e[t]||"*"!==e[t+1]||(Ee.removeCSSComments||(Ee.removeCSSComments=!0),n.removeCSSComments&&(v=t)),y&&e.startsWith("![endif",t+1)&&(y=!1),!s&&!m&&!T&&null!==b){let r;e.startsWith("--\x3e",t)?r=3:">"===e[t]&&"]"===e[t-1]&&(r=1),r&&([w,O]=he({str:e,from:b,to:t+r}),b=null,null!=w?n.lineLengthLimit&&d-(O-w)>=n.lineLengthLimit?(xe.push(w,O,D),d=-r):(xe.push(w,O),d-=O-w):(h+=r-1,t+=r-1),s=t+r)}if(s||m||T||!e.startsWith("\x3c!--",t)||null!==b||(e.startsWith("[if",t+4)?(y||(y=!0),2===n.removeHTMLComments&&(b=t)):!n.removeHTMLComments||y&&2!==n.removeHTMLComments||(b=t),Ee.removeHTMLComments||(Ee.removeHTMLComments=!0)),!s&&m&&null===v&&e.startsWith("</style",t)&&!Ne(e[t+7])?m=!1:s||m||null!==v||!e.startsWith("<style",t)||Ne(e[t+6])||(m=!0,(n.removeLineBreaks||n.removeIndentations)&&n.breakToTheLeftOf.includes("<style")&&e.startsWith(' type="text/css">',t+6)&&e[t+24]&&xe.push(t+23,t+23,D)),!s&&!T&&"\"'".includes(e[t])&&e.endsWith("style=",t)&&(T=t),s||e[t].trim()){if(!s&&(!m&&!T||null===v)){if(null!==c){if(n.removeLineBreaks&&(h+=1),k)k=!1,(n.removeIndentations||n.removeLineBreaks)&&xe.push(0,t);else if(n.removeIndentations&&!n.removeLineBreaks&&(!f&&null!==o&&t>o?xe.push(o+1,t):c+1<t&&(e.endsWith("]>",c)||e.endsWith("--\x3e",c)||e.startsWith("<![",t)||e.startsWith("\x3c!--<![",t)?xe.push(c,t):" "===e[c]?xe.push(c+1,t):" "===e[~-t]?xe.push(c,~-t):xe.push(c,t," "))),n.removeLineBreaks||T){if(i.includes(e[t])&&a(e,t,n.breakToTheLeftOf)){"\r\n".includes(e[~-t])&&c===~-t||"\n"===e[~-t]&&"\r"===e[t-2]&&c===t-2||xe.push(c,t,D),w=null,O=null,S=null,c=null,h=1;continue}let r=" ";"<"===e[t]&&u(e,t,n.mindTheInlineTags,{cb:e=>!e||!/\w/.test(e)})||(e[~-c]&&R.includes(e[~-c])&&W.includes(e[t])||(m||T)&&null===v&&(F.includes(e[~-c])||x.includes(e[t]))||e.startsWith("!important",t)&&!y||T&&("'"===e[~-c]||'"'===e[~-c])||"}"===e[~-c]&&e.startsWith("</style",t)||">"===e[t]&&("'\"".includes(e[p(e,t)])||"<"===e[g(e,t)])||"/"===e[t]&&">"===e[g(e,t)])&&(r="","/"===e[t]&&">"===e[t+1]&&g(e,t)&&g(e,t)>t+1&&(xe.push(t+1,g(e,t)),h-=g(e,t)-t+1)),m&&"}"===e[t]&&c&&"}"===e[c-1]&&(r=" "),r&&r.length&&(h+=1),n.lineLengthLimit?h>=n.lineLengthLimit||!e[t+1]||">"===e[t]||"/"===e[t]&&">"===e[t+1]?((h>n.lineLengthLimit||h===n.lineLengthLimit&&e[t+1]&&e[t+1].trim()&&!L.includes(e[t])&&!$.includes(e[t+1]))&&(r=D,h=1),(h>n.lineLengthLimit||" "!==r||t!==c+1)&&(xe.push(c,t,r),o=null),w=null,O=null,S=null):(null===w||c<w)&&(w=c,O=t,S=r):t===c+1&&" "===r||xe.push(c,t,r)}c=null,f||(f=!0)}else k&&(k=!1),n.removeLineBreaks&&(h+=1);f||(f=!0)}}else null===c&&(c=t);if(!s&&!k&&0!==t&&n.removeLineBreaks&&(n.lineLengthLimit||i)&&!e.startsWith("</a",t)){if(i&&a(e,t,n.breakToTheLeftOf)&&e.slice(0,t).trim()&&(!e.startsWith("<![endif]",t)||!l(e,t,"\x3c!--"))){xe.push(t,t,D),w=null,O=null,S=null,h=1;continue}if(n.lineLengthLimit&&h<=n.lineLengthLimit){if(!e[t+1]||$.includes(e[t])&&!M.includes(e[t])||L.includes(e[t])||!e[t].trim()){if(null!==w&&null!==O&&(w!==O||S&&S.length)){let r=S;e[t].trim()&&e[t+1]&&e[t+1].trim()&&h+(S?S.length:0)>n.lineLengthLimit&&(r=D),(h+(r?r.length:0)>n.lineLengthLimit||" "!==r||O!==w+1||" "!==e[w])&&("}"===e[~-w]&&"{"===e[O]||(xe.push(w,O,r),o=null))}!(e[t].trim()&&($.includes(e[t])||e[~-t]&&L.includes(e[~-t]))&&He(C))||A&&n.mindTheInlineTags.includes(A)||"<"===e[t]&&u(e,t,n.mindTheInlineTags,{cb:e=>!e||!/\w/.test(e)})||"<"===e[t]&&u(e,t,n.mindTheInlineTags,{trimCharsBeforeMatching:"/",cb:e=>!e||!/\w/.test(e)})?null!==v||null===w||!(T||!n.mindTheInlineTags||!Array.isArray(n.mindTheInlineTags)||Array.isArray(n.mindTheInlineTags.length)&&!n.mindTheInlineTags.length||!He(A)||Array.isArray(n.mindTheInlineTags)&&n.mindTheInlineTags.length&&He(A)&&!n.mindTheInlineTags.includes(A))||"<"===e[t]&&u(e,t,n.mindTheInlineTags,{trimCharsBeforeMatching:"/",cb:e=>!e||!/\w/.test(e)})||(w=null,O=null,S=null):(w=t,O=t,S=null)}}else if(n.lineLengthLimit)if(!$.includes(e[t])||"<"===e[t]&&u(e,t,n.mindTheInlineTags,{trimCharsBeforeMatching:"/",cb:e=>!e||!/\w/.test(e)}))e[t+1]&&L.includes(e[t])&&He(A)&&Array.isArray(n.mindTheInlineTags)&&n.mindTheInlineTags.length&&!n.mindTheInlineTags.includes(A)?null!==w&&null!==O&&(w!==O||S&&S.length)||(xe.push(t+1,t+1,D),h=0):e[t].trim()&&(e[t+1]||null!==w&&null!==O&&(w!==O||S&&S.length)&&xe.push(w,O,D));else if(null!==w&&null!==O&&(w!==O||S&&S.length)){const e=S&&S.length?S.length:0;h-(O-w-e)-1>n.lineLengthLimit||(xe.push(w,O,S),h-(O-w-e)-1===n.lineLengthLimit&&(xe.push(t,t,D),h=0),w=null,O=null,S=null)}else xe.push(t,t,D),h=0}if(!s&&!k&&n.removeLineBreaks&&n.lineLengthLimit&&h>=n.lineLengthLimit&&null!==w&&null!==O&&!L.includes(e[t])&&!$.includes(e[t])&&!"/".includes(e[t])&&(h!==n.lineLengthLimit||!e[t+1]||e[t+1].trim())){let r=D;e[t+1]&&!e[t+1].trim()&&h===n.lineLengthLimit&&(r=S),r===D&&!e[~-w].trim()&&p(e,w)&&(w=p(e,w)+1),xe.push(w,O,r),h=t-O,e[t].length&&(h+=1),w=null,O=null,S=null}if((!s&&"\n"===e[t]||"\r"===e[t]&&(!e[t+1]||e[t+1]&&"\n"!==e[t+1]))&&(o=t,f&&(f=!1),!n.removeLineBreaks&&null!==c&&c<t&&e[t+1]&&"\r"!==e[t+1]&&"\n"!==e[t+1]&&xe.push(c,t)),e[t+1]||(m&&null!==v?xe.push(...he({str:e,from:v,to:t,ifLeftSideIncludesThisThenCropTightly:F,ifRightSideIncludesThisThenCropTightly:x})):c&&"\n"!==e[t]&&"\r"!==e[t]?xe.push(c,t+1):c&&("\r"===e[t]&&"\n"===e[t+1]||"\n"===e[t]&&"\r"!==e[t-1])&&xe.push(c,t)),!s&&T&&T<t&&e[T]===e[t]&&(T=null),!s&&!m&&e.startsWith("<pre",t)&&!Ne(e[t+4])){const r=e.indexOf("</pre",t+5);r>0&&(s=r)}if(!s&&!m&&e.startsWith("<code",t)&&!Ne(e[t+5])){const r=e.indexOf("</code",t+5);r>0&&(s=r)}if(!s&&e.startsWith("<![CDATA[",t)){const r=e.indexOf("]]>",t+9);r>0&&(s=r)}s||m||T||null===I||">"!==e[t]||("<"===e[g(e,t)]&&(C=A),I=null,A=null),"<"===e[t]&&null!==C&&(C=null),m&&"{"===e[t]&&"{"===e[t+1]&&-1!==e.indexOf("}}")&&(s=e.indexOf("}}")+2)}else{if((n.removeIndentations||n.removeLineBreaks)&&t>0&&e[~-t]&&!e[~-t].trim())for(let r=t;r--;)if("\n"===e[r]||"\r"===e[r]||e[r].trim()){r+1<t&&xe.push(r+1,t);break}_=null,s=!1,t+=8}if(xe.current()){const t=xe.current();xe.wipe();const i=n.reportProgressFuncTo-.01*(n.reportProgressFuncTo-n.reportProgressFuncFrom),s=ve(e,t,(e=>{n.reportProgressFunc&&E>=2e3&&(P=Math.floor(i+e/100*(n.reportProgressFuncTo-i)),P!==B&&(B=P,n.reportProgressFunc(P)))})),o=s.length;return{log:{timeTakenInMilliseconds:Date.now()-r,originalLength:E,cleanedLength:o,bytesSaved:Math.max(E-o,0),percentageReducedOfOriginal:E?Math.round(100*Math.max(E-o,0)/E):0},ranges:t,applicableOpts:Ee,result:s}}}return{log:{timeTakenInMilliseconds:Date.now()-r,originalLength:E,cleanedLength:E,bytesSaved:0,percentageReducedOfOriginal:0},applicableOpts:Ee,ranges:null,result:e}}var Be="__lodash_hash_undefined__",De="[object Function]",Je="[object GeneratorFunction]",qe=/^\[object .+?Constructor\]$/,ze="object"==typeof self&&self&&self.Object===Object&&self,Ue="object"==typeof c&&c&&c.Object===Object&&c||ze||Function("return this")();function Ge(e,t){return!!(e?e.length:0)&&function(e,t,r){if(t!=t)return function(e,t,r,n){var i=e.length,s=r+(n?1:-1);for(;n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}(e,Ze,r);var n=r-1,i=e.length;for(;++n<i;)if(e[n]===t)return n;return-1}(e,t,0)>-1}function Ve(e,t,r){for(var n=-1,i=e?e.length:0;++n<i;)if(r(t,e[n]))return!0;return!1}function Ze(e){return e!=e}function Ye(e,t){return e.has(t)}function Ke(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var Qe=Array.prototype,Xe=Function.prototype,et=Object.prototype,tt=Ue["__core-js_shared__"],rt=function(){var e=/[^.]+$/.exec(tt&&tt.keys&&tt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),nt=Xe.toString,it=et.hasOwnProperty,st=et.toString,ot=RegExp("^"+nt.call(it).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),lt=Qe.splice,at=vt(Ue,"Map"),ut=vt(Ue,"Set"),ct=vt(Object,"create");function ft(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ht(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function gt(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function pt(e){var t=-1,r=e?e.length:0;for(this.__data__=new gt;++t<r;)this.add(e[t])}function dt(e,t){for(var r,n,i=e.length;i--;)if((r=e[i][0])===(n=t)||r!=r&&n!=n)return i;return-1}function mt(e){if(!bt(e)||function(e){return!!rt&&rt in e}(e))return!1;var t=function(e){var t=bt(e)?st.call(e):"";return t==De||t==Je}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?ot:qe;return t.test(function(e){if(null!=e){try{return nt.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}ft.prototype.clear=function(){this.__data__=ct?ct(null):{}},ft.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},ft.prototype.get=function(e){var t=this.__data__;if(ct){var r=t[e];return r===Be?void 0:r}return it.call(t,e)?t[e]:void 0},ft.prototype.has=function(e){var t=this.__data__;return ct?void 0!==t[e]:it.call(t,e)},ft.prototype.set=function(e,t){return this.__data__[e]=ct&&void 0===t?Be:t,this},ht.prototype.clear=function(){this.__data__=[]},ht.prototype.delete=function(e){var t=this.__data__,r=dt(t,e);return!(r<0)&&(r==t.length-1?t.pop():lt.call(t,r,1),!0)},ht.prototype.get=function(e){var t=this.__data__,r=dt(t,e);return r<0?void 0:t[r][1]},ht.prototype.has=function(e){return dt(this.__data__,e)>-1},ht.prototype.set=function(e,t){var r=this.__data__,n=dt(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},gt.prototype.clear=function(){this.__data__={hash:new ft,map:new(at||ht),string:new ft}},gt.prototype.delete=function(e){return Tt(this,e).delete(e)},gt.prototype.get=function(e){return Tt(this,e).get(e)},gt.prototype.has=function(e){return Tt(this,e).has(e)},gt.prototype.set=function(e,t){return Tt(this,e).set(e,t),this},pt.prototype.add=pt.prototype.push=function(e){return this.__data__.set(e,Be),this},pt.prototype.has=function(e){return this.__data__.has(e)};var yt=ut&&1/Ke(new ut([,-0]))[1]==1/0?function(e){return new ut(e)}:function(){};function Tt(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function vt(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return mt(r)?r:void 0}function bt(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var _t=function(e){return e&&e.length?function(e,t,r){var n=-1,i=Ge,s=e.length,o=!0,l=[],a=l;if(r)o=!1,i=Ve;else if(s>=200){var u=t?null:yt(e);if(u)return Ke(u);o=!1,i=Ye,a=new pt}else a=t?[]:l;e:for(;++n<s;){var c=e[n],f=t?t(c):c;if(c=r||0!==c?c:0,o&&f==f){for(var h=a.length;h--;)if(a[h]===f)continue e;t&&a.push(f),l.push(c)}else i(a,f,r)||(a!==l&&a.push(f),l.push(c))}return l}(e):[]};const wt=/[\n]?\s*<style[^>]*>\s*<\/style\s*>/g,Ot=/[\n]?\s*@(media|supports|document)[^{]*{\s*}/g,St=/@media[^{@}]+{(?=\s*<\/style>)/g;function At(e){return e&&"object"==typeof e&&!Array.isArray(e)}function It(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ct(e){return"string"==typeof e&&1===e.length&&(e.charCodeAt(0)>64&&e.charCodeAt(0)<91||e.charCodeAt(0)>96&&e.charCodeAt(0)<123)}const Lt={whitelist:[],backend:[],uglify:!1,removeHTMLComments:!0,removeCSSComments:!0,doNotRemoveHTMLCommentsWhoseOpeningTagContains:["[if","[endif"],reportProgressFunc:null,reportProgressFuncFrom:0,reportProgressFuncTo:100};e.comb=function(e,t){const r=Date.now(),n=new Fe({limitToBeAddedWhitespace:!0}),i=new Fe,s=new Fe;function o(e){return/[-_A-Za-z0-9]/.test(e)}function c(e={}){return{valuesStart:null,valueStart:null,nameStart:null,quoteless:!1,...e}}let f,h;const m=[],y=[],T=[];let v,O,S,A,I;const C={};let L,$,M,R,W,j,F,x,k,E,H=0,N=null,P=[],B=0,D=0,J=0,q=!1,z=null,U=!1,G=null,V=0,Z=0;const Y=".# ~\\!@$%^&*()+=,/';:\"?><[]{}|`\t\n",K=["media","supports","document"],Q=["font-feature-values","counter-style","namespace","font-face","keyframes","viewport","charset","import","page"],X=["{","(","<",'"',"'","@",";"];if("string"!=typeof e)throw new TypeError("email-comb: [THROW_ID_01] Input must be string! Currently it's "+typeof e);if(t&&!At(t))throw new TypeError(`email-comb: [THROW_ID_02] Options, second input argument, must be a plain object! Currently it's ${typeof t}, equal to: ${JSON.stringify(t,null,4)}`);const ee={...Lt,...t};if("string"==typeof ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains&&(ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains=[ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains].filter((e=>e.trim()))),"string"==typeof ee.whitelist)ee.whitelist=[ee.whitelist];else if(!Array.isArray(ee.whitelist))throw new TypeError(`email-comb: [THROW_ID_03] opts.whitelist should be an array, but it was customised to a wrong thing, ${JSON.stringify(ee.whitelist,null,4)}`);if(ee.whitelist.length>0&&!ee.whitelist.every((e=>"string"==typeof e)))throw new TypeError(`email-comb: [THROW_ID_04] opts.whitelist array should contain only string-type elements. Currently we\ve got:\n${JSON.stringify(ee.whitelist,null,4)}`);if(!Array.isArray(ee.backend))throw new TypeError(`email-comb: [THROW_ID_05] opts.backend should be an array, but it was customised to a wrong thing, ${JSON.stringify(ee.backend,null,4)}`);if(ee.backend.length>0&&ee.backend.some((e=>!At(e))))throw new TypeError(`email-comb: [THROW_ID_06] opts.backend array should contain only plain objects but it contains something else:\n${JSON.stringify(ee.backend,null,4)}`);if(ee.backend.length>0&&!ee.backend.every((e=>It(e,"heads")&&It(e,"tails"))))throw new TypeError(`email-comb: [THROW_ID_07] every object within opts.backend should contain keys "heads" and "tails" but currently it's not the case. Whole "opts.backend" value array is currently equal to:\n${JSON.stringify(ee.backend,null,4)}`);if("boolean"!=typeof ee.uglify){if(1!==ee.uglify&&0!==ee.uglify)throw new TypeError(`email-comb: [THROW_ID_08] opts.uglify should be a Boolean. Currently it's set to: ${JSON.stringify(ee.uglify,null,4)}}`);ee.uglify=!!ee.uglify}if(ee.reportProgressFunc&&"function"!=typeof ee.reportProgressFunc)throw new TypeError(`email-comb: [THROW_ID_09] opts.reportProgressFunc should be a function but it was given as :\n${JSON.stringify(ee.reportProgressFunc,null,4)} (${typeof ee.reportProgressFunc})`);let te=null,re=null;Array.isArray(ee.backend)&&ee.backend.length&&(te=ee.backend.map((e=>e.heads)),re=ee.backend.map((e=>e.tails)));const ne=ee.whitelist.filter((e=>!e.startsWith("#")&&!e.startsWith("."))),ie=e.length;let se=1;ee.reportProgressFunc&&(se=Math.floor((ee.reportProgressFuncTo-.06*(ee.reportProgressFuncTo-ee.reportProgressFuncFrom)-ee.reportProgressFuncFrom)/2));let oe,le,ae=0;e.length&&"\r\n".includes(e[e.length-1])||(ae=1);let ue,fe,ge,de,me,ye,Te,be,_e=[],we=[],Oe=[],Se=[],Ie={},Ce=[],Le=0,$e=[],Me=[],Re=[];for(let t=1;t<=2;t++){L=!1,j=null,q=!1,E=!0,k=!0,A=c(),M=!0,U=!1,F=null,I=c(),O=null,z=null,ge=null,fe=!1,de=null,$=!1,W=null,me=!1,v=null,le=null,f=null,S=null,ye=null,h=null,oe=!1,H+=ie;e:for(let r=0;r<ie;r++){ee.reportProgressFunc&&(ie>1e3&&ie<2e3?1===t&&0===r&&ee.reportProgressFunc(Math.floor((ee.reportProgressFuncTo-ee.reportProgressFuncFrom)/2)):ie>=2e3&&(ue=ee.reportProgressFuncFrom+Math.floor(r/ie*se)+(1===t?0:se),ue!==Le&&(Le=ue,ee.reportProgressFunc(ue))));const s=e[r];if(!0!==fe&&(null===h&&null!==f&&r>=f||null!==f&&null!==h&&f>h&&f<r)?(fe=!0,me=!1):!0!==me&&null!==S&&(null===f||f<r)&&(null===h||h<r)&&(me=!0,fe=!1),!oe&&('"'===e[r]||"'"===e[r]))if(ge){if('"'===e[r]&&"'"===e[g(e,r)]&&'"'===e[g(e,g(e,r))]||"'"===e[r]&&'"'===e[g(e,r)]&&"'"===e[g(e,g(e,r))]){r=g(e,g(e,r));continue}ge===e[r]&&(ge=null)}else{const t=p(e,r);"number"==typeof t&&(fe&&["(",",",":"].includes(e[t])||me&&!fe&&["(",",",":","="].includes(e[t]))&&(ge=e[r])}if(oe)if(null===le||"string"!=typeof le||"string"==typeof le&&!le)oe=!1;else if(a(e,r,le)){if(null!==v){if(1===t&&ee.removeCSSComments){const t=l(e,v,["\r\n","\n","\r"]);let i=v;"string"==typeof t&&t.length&&(i-=t.length),e[i-1]&&o(e[i-1])&&e[r+le.length]&&o(e[r+le.length])?(n.push(i,r+le.length,";"),Z+=r+le.length-i):(n.push(i,r+le.length),Z+=r+le.length-i)}v=null}r=r+le.length-1,le=null,oe=!1;continue}if(!oe&&"<"===e[r]&&"s"===e[r+1]&&"t"===e[r+2]&&"y"===e[r+3]&&"l"===e[r+4]&&"e"===e[r+5]){L=!0,fe||(fe=!0);for(let t=r;t<ie;t++)if(H+=1,">"===e[t]){f=t+1,W=t+1;break}}if(!oe&&fe&&"<"===e[r]&&"/"===e[r+1]&&"s"===e[r+2]&&"t"===e[r+3]&&"y"===e[r+4]&&"l"===e[r+5]&&"e"===e[r+6]&&(h=r-1,W=null,L=!1,fe&&(fe=!1)),1!==t||!fe&&!me||"/"!==e[r]||"*"!==e[r+1]||null!==v){if(!oe&&fe&&"@"===e[r]){de&&(de=null);const i=u(e,r,K)||u(e,r,Q);if("string"==typeof i){let s,o;(";"===e[r+i.length+1]||e[r+i.length+1]&&!e[r+i.length+1].trim()&&u(e,r+i.length+1,";",{trimBeforeMatching:!0,cb:(e,t,r)=>(s=r,!0)}))&&n.push(r,s||r+i.length+2);for(let s=r+1;s<ie;s++){H+=1;let l="";if("{"===e[s]&&"{"===e[s+1]&&(l="}}"),"{"===e[s]&&"%"===e[s+1]&&(l="%}"),l&&e.includes(l,s+1))s=e.indexOf(l,s+1)+l.length-1;else if(l&&(l=""),o&&e[s]===o){if("}"===e[s]&&Q.includes(i)||"{"===e[s]&&K.includes(i)){r=s,W=s+1;continue e}o=void 0}else if('"'!==e[s]||o?"'"!==e[s]||o?"("!==e[s]||o?Q.includes(i)&&"{"===e[s]&&!o&&(o="}"):o=")":o="'":o='"',!o&&X.includes(e[s])){let i,o;if("{"===e[s]||";"===e[s]){$=!1,W=s+1,r=s;continue e}"@"!==e[s]&&"<"!==e[s]||1!==t||e.slice(r,s).includes("{")||e.slice(r,s).includes("(")||e.slice(r,s).includes('"')||e.slice(r,s).includes("'")||(i=r,o=s+(";"===e[s]?1:0),n.push(i,o));const l=o?o-1:s-1+("{"===e[s]?1:0);r=l,W=l+1;continue e}}}}if(!oe&&fe&&$&&L&&"}"===s&&!ge&&!J&&(2===t&&k&&W&&n.push(W,r+1),$=!1,W&&(W=r+1),j=null,q=!1,k=!0,F=null,z=null,U=!1),!oe&&!v&&f&&r>=f&&(null===h&&r>=f||h&&f>h&&f<=r)&&!$){if(null===F){if("."===s||"#"===s)F=r;else if(l(e,r,"[class="))Ct(s)?(F=r,x="."):"\"'".includes(s)&&Ct(e[g(e,r)])&&(F=g(e,r),x=".");else if(l(e,r,"[id="))Ct(s)?(F=r,x="#"):"\"'".includes(s)&&Ct(e[g(e,r)])&&(F=g(e,r),x="#");else if(s.trim())if("}"===s)W=r+1,ye=null;else if("<"===s&&"!"===e[r+1])for(let t=r;t<ie;t++)if(H+=1,">"===e[t]){W=t+1,j=t+1,r=t;continue e}}else if(null!==F&&!o(s)){let n=e.slice(F,r);x&&(n=`${x}${n}`,x=void 0),2===t&&!q&&Re.includes(n)?(q=!0,U=!0):2!==t||q||(!ee.uglify||Array.isArray(ee.whitelist)&&ee.whitelist.length&&b([n],ee.whitelist).length||i.push(F,r,P[we.indexOf(n)]),","===s&&(z=r,U=!1)),F="."===s||"#"===s?r:null}if(null===j)!s.trim()||"}"===s||";"===s||"/"===e[r]&&"*"===e[r+1]||(q=!1,j=r);else if(",{".includes(s)){if(ye=e.slice(j,de||r),2===t&&q&&ne.length&&b([ye],ne).length&&(q=!1),1===t)de&&(","===s&&de<r?(n.push(de,r),V+=r-de):"{"===s&&de<r-1&&(n.push(de,r-1),V+=r-1-de)),m.push(ye);else if(q){let t=j,o=r,a=0;if("{"===s&&">"!==e[t-1]&&"}"!==e[t-1]){for(let r=j;r--;)if(H+=1,e[r].trim()&&","!==e[r]){t=r+1;break}e[r-1].trim()||(o=r-1)}else if(","!==s||e[r+1].trim())l(e,t,"{",{trimBeforeMatching:!0,cb:(e,t,r)=>(a=r,!0)})&&(t=a+2);else for(let t=r+1;t<ie;t++)if(H+=1,e[t].trim()){o=t;break}const u=he({str:e,from:t,to:o,ifRightSideIncludesThisThenCropTightly:".#",ifRightSideIncludesThisCropItToo:",",extendToOneSide:"right"});n.push(...u),ee.uglify&&i.wipe()}else k&&(k=!1),U&&(U=!1),ee.uglify&&(n.push(i.current()),i.wipe());if("{"!==s)j=null;else if(2===t&&!k&&null!==z&&U){let t=z+1;if("\n\r".includes(e[z+1]))for(let r=z+1;r<ie;r++)if(e[r].trim()){t=r;break}n.push(z,t),z=null,U=!1}}}if(!oe&&!fe&&me&&"/"===e[r]&&u(e,r,"body",{trimBeforeMatching:!0,i:!0})&&l(e,r,"<",{trimBeforeMatching:!0})&&(me=!1,S=null),!oe&&"<"===e[r]&&u(e,r,"body",{i:!0,trimBeforeMatching:!0,cb:(e,i,s)=>{if(1===t){if(void 0!==e&&(""===e.trim()||">"===e)&&"number"==typeof s){if(!(s-r>5))return!0;n.push(r,s,"<body"),V+=s-r-5}return!0}return!0}}))for(let t=r;t<ie;t++)if(H+=1,">"===e[t]){S=t+1;break}if(!oe&&me&&!fe&&"s"===e[r]&&"t"===e[r+1]&&"y"===e[r+2]&&"l"===e[r+3]&&"e"===e[r+4]&&"="===e[r+5]&&Y.includes(e[r-1])&&"\"'".includes(e[r+6]),!oe&&me&&!fe&&!ge&&"c"===e[r]&&"l"===e[r+1]&&"a"===e[r+2]&&"s"===e[r+3]&&"s"===e[r+4]&&e[r-1]&&!e[r-1].trim()){let i,s=!1;if("="===e[r+5]){if('"'===e[r+6]||"'"===e[r+6])i=r+7;else if(o(e[r+6]))i=r+6,s=!0;else if(e[r+6]&&(!e[r+6].trim()||"/>".includes(e[r+6]))){const t=he({str:e,from:r,to:r+6,ifRightSideIncludesThisThenCropTightly:"/>",wipeAllWhitespaceOnLeft:!0});n.push(...t)}}else if(!e[r+5].trim())for(let s=r+5;s<ie;s++)if(H+=1,e[s].trim()){if("="===e[s])if(s>r+5&&1===t&&n.push(r+5,s),'"'!==e[s+1]&&"'"!==e[s+1]||!e[s+2]){if(e[s+1]&&!e[s+1].trim())for(let r=s+1;r<ie;r++)if(H+=1,e[r].trim()){r>s+1&&1===t&&n.push(s+1,r),'"'!==e[r]&&"'"!==e[r]||!e[r+1]||(i=r+1);break}}else i=s+2;break}i&&(A=c({valuesStart:i,quoteless:s,nameStart:r}),1===t?M=!0:2===t&&(E=!0))}if(!oe&&me&&!fe&&!ge&&"i"===e[r]&&"d"===e[r+1]&&e[r-1]&&!e[r-1].trim()){let i,s=!1;if("="===e[r+2]){if('"'===e[r+3]||"'"===e[r+3])i=r+4;else if(o(e[r+3]))i=r+3,s=!0;else if(e[r+3]&&(!e[r+3].trim()||"/>".includes(e[r+3]))){const t=he({str:e,from:r,to:r+3,ifRightSideIncludesThisThenCropTightly:"/>",wipeAllWhitespaceOnLeft:!0});n.push(...t)}}else if(!e[r+2].trim())for(let s=r+2;s<ie;s++)if(H+=1,e[s].trim()){if("="===e[s])if(s>r+2&&1===t&&n.push(r+2,s),'"'!==e[s+1]&&"'"!==e[s+1]||!e[s+2]){if(e[s+1]&&!e[s+1].trim())for(let r=s+1;r<ie;r++)if(H+=1,e[r].trim()){r>s+1&&1===t&&n.push(s+1,r),'"'!==e[r]&&"'"!==e[r]||!e[r+1]||(i=r+1);break}}else i=s+2;break}i&&(I=c({valuesStart:i,quoteless:s,nameStart:r}),1===t?M=!0:2===t&&(E=!0))}if(!oe&&null!==A.valuesStart&&r>=A.valuesStart&&null===A.valueStart)if(te&&a(e,r,te)){if(oe=!0,E=!1,de&&r>de+1){const t=he({str:e,from:de,to:r,ifLeftSideIncludesThisThenCropTightly:"\"'",ifRightSideIncludesThisThenCropTightly:"\"'"});n.push(...t),de=null}else de&&(de=null);const t=a(e,r,te),i=ee.backend.find((e=>e.heads===t));i&&i.tails&&(le=i.tails)}else o(s)&&(A.valueStart=r,1===t&&(M&&null!==A.valuesStart&&!e.slice(A.valuesStart,r).trim()&&A.valuesStart<r?(n.push(A.valuesStart,r),V+=r-A.valuesStart,M=!1):null!==de&&de<r-1&&(n.push(de+1,r),V+=r-de+1)));if(!oe&&null!==A.valueStart&&r>A.valueStart&&(!o(s)||re&&a(e,r,re)))if(te&&a(e,r,te)){A.valueStart=null,A=c();const t=a(e,r,te),n=ee.backend.find((e=>e.heads===t));n&&n.tails&&(le=n.tails)}else{const i=`${e.slice(A.valueStart,r)}`;if(1===t)y.push(`.${i}`);else if(null!=A.valueStart&&Ce.includes(i)){const t=he({str:e,from:A.valueStart,to:r,ifLeftSideIncludesThisThenCropTightly:"\"'",ifRightSideIncludesThisThenCropTightly:"\"'",wipeAllWhitespaceOnLeft:!0});let i="";e[t[0]-1]&&e[t[0]-1].trim()&&e[t[1]]&&e[t[1]].trim()&&(te||re)&&(te&&l(e,t[0],re)||re&&a(e,t[1],te))&&(i=" "),n.push(...t,i)}else E=!1,!ee.uglify||Array.isArray(ee.whitelist)&&ee.whitelist.length&&b([`.${i}`],ee.whitelist).length||n.push(A.valueStart,r,P[we.indexOf(`.${i}`)].slice(1));A.valueStart=null}if(!oe&&I&&null!==I.valueStart&&r>I.valueStart&&(!o(s)||re&&a(e,r,re))){const i=e.slice(I.valueStart,r);if(1===t)T.push(`#${i}`);else if(null!=I.valueStart&&$e.includes(i)){const t=he({str:e,from:I.valueStart,to:r,ifRightSideIncludesThisThenCropTightly:"\"'",wipeAllWhitespaceOnLeft:!0});e[t[0]-1]&&e[t[0]-1].trim()&&e[t[1]]&&e[t[1]].trim()&&(te||re)&&(te&&l(e,t[0],re||[])||re&&a(e,t[1],te||[]))&&(t[0]+=1),n.push(...t)}else E=!1,!ee.uglify||Array.isArray(ee.whitelist)&&ee.whitelist.length&&b([`#${i}`],ee.whitelist).length||n.push(I.valueStart,r,P[we.indexOf(`#${i}`)].slice(1));I.valueStart=null}if(!oe&&null!=A.valuesStart&&(!A.quoteless&&("'"===s||'"'===s)||A.quoteless&&!o(e[r]))&&r>=A.valuesStart){if(r===A.valuesStart)1===t&&n.push(...he({str:e,from:A.nameStart,to:r+1,ifRightSideIncludesThisThenCropTightly:"/>",wipeAllWhitespaceOnLeft:!0}));else{if(2===t&&E){const t=he({str:e,from:A.valuesStart-7,to:"'\"".includes(e[r])?r+1:r,ifRightSideIncludesThisThenCropTightly:"/>",wipeAllWhitespaceOnLeft:!0});let i="";e[t[0]-1]&&e[t[0]-1].trim()&&e[t[1]]&&e[t[1]].trim()&&!"/>".includes(e[t[1]])&&(i=" "),n.push(...t,i)}null!==de&&n.push(de,r)}A=c()}if(!oe&&null!==I.valuesStart&&(!I.quoteless&&("'"===s||'"'===s)||I.quoteless&&!o(e[r]))&&r>=I.valuesStart){if(r===I.valuesStart)1===t&&n.push(...he({str:e,from:I.nameStart,to:r+1,ifRightSideIncludesThisThenCropTightly:"/>",wipeAllWhitespaceOnLeft:!0}));else{if(2===t&&E){const t=he({str:e,from:I.valuesStart-4,to:r+1,ifRightSideIncludesThisThenCropTightly:"/>",wipeAllWhitespaceOnLeft:!0});let i="";e[t[0]-1]&&e[t[0]-1].trim()&&e[t[1]]&&e[t[1]].trim()&&!"/>".includes(e[t[1]])&&(i=" "),n.push(...t,i)}null!==de&&n.push(de,r)}I=c()}if(!oe&&I.valuesStart&&r>=I.valuesStart&&null===I.valueStart)if(te&&a(e,r,te)){if(oe=!0,E=!1,de&&r>de+1){const t=he({str:e,from:de,to:r,ifLeftSideIncludesThisThenCropTightly:"\"'",ifRightSideIncludesThisThenCropTightly:"\"'"});n.push(...t),de=null}else de&&(de=null);const t=a(e,r,te),i=ee.backend.find((e=>e.heads===t));i&&i.tails&&(le=i.tails)}else o(s)&&(I.valueStart=r,1===t&&(M&&null!==I.valuesStart&&!e.slice(I.valuesStart,r).trim()&&I.valuesStart<r?(n.push(I.valuesStart,r),V+=r-I.valuesStart,M=!1):null!==de&&de<r-1&&(n.push(de+1,r),V+=r-de+1)));if(!oe&&1===t){if(null!==v&&v<r&&">"===e[r]&&!be&&(ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains&&Array.isArray(ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains)&&ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains.length&&ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains.some((t=>t.trim()&&e.slice(v,r).toLowerCase().includes(t)))&&(Te=!1),be=!0),null!==v&&">"===e[r])if(R||"-"!==e[r-1]||"-"!==e[r-2]){if(R){const t=he({str:e,from:v,to:r+1,wipeAllWhitespaceOnLeft:!0,addSingleSpaceToPreventAccidentalConcatenation:!0});ee.removeHTMLComments&&Te&&n.push(...t),Z+=t[1]-t[0],v=null,R=void 0}}else{const t=he({str:e,from:v,to:r+1,wipeAllWhitespaceOnLeft:!0,addSingleSpaceToPreventAccidentalConcatenation:!0});ee.removeHTMLComments&&Te&&n.push(...t),Z+=t[1]-t[0],v=null,R=void 0}ee.removeHTMLComments&&null===v&&"<"===e[r]&&"!"===e[r+1]&&((!te||Array.isArray(te)&&te.length&&!te.includes("<!"))&&(!re||Array.isArray(re)&&re.length&&!re.includes("<!"))&&(u(e,r+1,"doctype",{i:!0,trimBeforeMatching:!0})||"-"===e[r+2]&&"-"===e[r+3]&&Array.isArray(ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains)&&ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains.length&&u(e,r+3,ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains,{trimBeforeMatching:!0})||(v=r,be=!1,Te=!0),R=!("-"===e[r+2]&&"-"===e[r+3])),v!==r&&(O=r))}if("}"===s&&J&&(J-=1),!oe&&"{"===s&&L&&($?J+=1:($=!0,null!==de&&(e.slice(de,r).includes("\n")||e.slice(de,r).includes("\r"))&&n.push(de,r))),oe||(e[r].trim()?null!==de&&(de=null):null===de&&(de=r)),!oe&&2===t&&Array.isArray(G)&&G.length&&r===G[0][0]){const e=G.shift();e&&e[1]-1>r&&(r=e[1]-1)}else if(null!==O&&">"===e[r]){O=null;let t=0;if(ee.removeHTMLComments&&Array.isArray(ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains)&&ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains.length&&(ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains.some((e=>e.includes("if")))||ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains.some((e=>e.includes("mso")))||ee.doNotRemoveHTMLCommentsWhoseOpeningTagContains.some((e=>e.includes("ie"))))&&u(e,r,"\x3c!--",{trimBeforeMatching:!0,cb:(e,r,n)=>(t=n,!0)})){u(e,t-1,"--\x3e",{trimBeforeMatching:!0,cb:(e,r,n)=>(t=n,!0)}),"number"==typeof t&&(r=t-1);continue}}}else v=r,oe=!0,le="*/",r+=1}if(1===t){Se=_t(y.concat(T)),m.forEach((e=>{d(e).res.forEach((e=>{Object.prototype.hasOwnProperty.call(C,e)?C[e]+=1:C[e]=1}))})),Ie={...C},Oe=_t(m.reduce(((e,t)=>e.concat(d(t).res)),[])),D=Oe.length;const e=Array.from(m);let t,r=[];for(let t=0,n=e.length;t<n;t++){let i;H+=1,null!=e[t]&&(i=d(e[t]).res),i&&!i.every((e=>Se.includes(e)))&&(r.push(...d(e[t]).res),e.splice(t,1),t-=1,n-=1)}r=_t(w(r,ee.whitelist)),t=e&&e.length?e.reduce(((e,t)=>e.concat(d(t).res)),[]):[],Re=w(Ae(_t(Array.from(Oe)),y.concat(T)),ee.whitelist),Me=_t(w(Ae(y.concat(T),t),ee.whitelist)),Re=_t(Re.concat(ce(r,Me))),Ce=Me.filter((e=>e.startsWith("."))).map((e=>e.slice(1))),$e=Me.filter((e=>e.startsWith("#"))).map((e=>e.slice(1))),_e=Object.keys(Ie).filter((e=>Ie[e]<1)),Ce=_t(Ce.concat(ce(w(Se,ee.whitelist),_e).filter((e=>"."===e[0])).map((e=>e.slice(1)))));const i=b(Se,ee.whitelist);Me=_t(Me.concat(Ce.map((e=>`.${e}`)),$e.map((e=>`#${e}`)))),we=Ae(Ae(Array.from(Oe),Me),Re),Array.isArray(i)&&i.length&&i.forEach((e=>{we.includes(e)||we.push(e)})),ee.uglify&&(P=pe(we)),B=we.length,N=ee.uglify?we.map(((e,t)=>[e,P[t]])).filter((e=>!ee.whitelist.some((t=>_(e[0],t))))):null,G=n.current()?Array.from(n.current()||[]):null}}n.push(s.current()),e.length&&n.current()&&(e=ve(e,n.current()),n.wipe());const We=ee.reportProgressFuncTo-.06*(ee.reportProgressFuncTo-ee.reportProgressFuncFrom);for(ee.reportProgressFunc&&ie>=2e3&&(ue=Math.floor(We+(ee.reportProgressFuncTo-We)/5),ue!==Le&&(Le=ue,ee.reportProgressFunc(ue)));Ot.test(e)||St.test(e);)H+=(e=(e=e.replace(Ot,"")).replace(St,"")).length;ee.reportProgressFunc&&ie>=2e3&&(ue=Math.floor(We+(ee.reportProgressFuncTo-We)/5*2),ue!==Le&&(Le=ue,ee.reportProgressFunc(ue))),H+=(e=e.replace(wt,"\n")).length,ee.reportProgressFunc&&ie>=2e3&&(ue=Math.floor(We+(ee.reportProgressFuncTo-We)/5*3),ue!==Le&&(Le=ue,ee.reportProgressFunc(ue)));let je=e.length;return H+=(e=e.replace(/<!(--)?\[if[^\]]*]>[<>!-\s]*<!\[endif\]\1>/gi,"")).length,je!==e.length&&(Z+=e.length-je),ee.reportProgressFunc&&ie>=2e3&&(ue=Math.floor(We+(ee.reportProgressFuncTo-We)/5*4),ue!==Le&&(Le=ue,ee.reportProgressFunc(ue))),je=(e=Pe(e,{removeLineBreaks:!1,removeIndentations:!1,removeHTMLComments:!1,removeCSSComments:!1,lineLengthLimit:500}).result).length,je!==e.length&&(V+=e.length-je),H+=e.length,ee.reportProgressFunc&&ie>=2e3&&(ue=Math.floor(We+(ee.reportProgressFuncTo-We)),ue!==Le&&(Le=ue,ee.reportProgressFunc(ue))),e.length&&(e[0].trim()&&e[e.length-1].trim()||e.length===e.trim().length||(V+=e.length-e.trim().length),e=e.trimStart()),e=e.replace(/ ((class|id)=["']) /g," $1"),{log:{timeTakenInMilliseconds:Date.now()-r,traversedTotalCharacters:H,traversedTimesInputLength:ie?Math.round(H/ie*100)/100:0,originalLength:ie,cleanedLength:e.length,bytesSaved:Math.max(ie-e.length,0),percentageReducedOfOriginal:ie?Math.round(100*Math.max(ie-e.length,0)/ie):0,nonIndentationsWhitespaceLength:Math.max(V-ae,0),nonIndentationsTakeUpPercentageOfOriginal:ie&&Math.max(V-ae,0)?Math.round(100*Math.max(V,0)/ie):0,commentsLength:Z,commentsTakeUpPercentageOfOriginal:ie&&Z?Math.round(100*Z/ie):0,uglified:N},result:e,countAfterCleaning:B,countBeforeCleaning:D,allInHead:Oe.sort(),allInBody:Se.sort(),deletedFromHead:Re.sort(),deletedFromBody:Me.sort()}},e.defaults=Lt,e.version="6.0.3",Object.defineProperty(e,"__esModule",{value:!0})}));
